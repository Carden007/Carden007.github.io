<!doctype html>



  


<html class="theme-next mist use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="人生有很多事情急不得，没有白走的路，走每一步都算数。">
<meta property="og:type" content="website">
<meta property="og:title" content="Carden&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Carden&#39;s Blog">
<meta property="og:description" content="人生有很多事情急不得，没有白走的路，走每一步都算数。">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Carden&#39;s Blog">
<meta name="twitter:description" content="人生有很多事情急不得，没有白走的路，走每一步都算数。">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>Carden's Blog</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  















  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Carden's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/09/直播服务/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Carden007">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://static.pexels.com/photos/33392/portrait-bird-nature-wild.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Carden's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/09/直播服务/" itemprop="url">直播服务</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-09T12:24:30+08:00">
                2017-06-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<h1 id="SDK说明"><a href="#SDK说明" class="headerlink" title="SDK说明"></a>SDK说明</h1></blockquote>
<p>1、SDK很大，767.3MB，客观条件限制</p>
<p>2、模拟器能编译SDK，但并不支持模拟器渲染直播，必须真机测试</p>
<p>3、编译超慢，通常把UI层和SDK逻辑层隔离开发，参照默认直播UI</p>
<p>4、版本支持8.0以上</p>
<p>5、Xcode8.1以上版本编译不通过，腾讯传输层SDK未升级导致</p>
<blockquote>
<h1 id="SDK架构"><a href="#SDK架构" class="headerlink" title="SDK架构"></a>SDK架构</h1></blockquote>
<p><a href="http://123.59.84.71:8000/weixinxian/JHLiveSDK" target="_blank" rel="external">JHLiveSDK下载</a><br><img src="http://upload-images.jianshu.io/upload_images/645301-bbdf1817c66e65d9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="SDK架构"></p>
<blockquote>
<h1 id="SDK集成"><a href="#SDK集成" class="headerlink" title="SDK集成"></a>SDK集成</h1></blockquote>
<p>1、将SDK文件夹中的文件添加到Xcode工程文件中。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/645301-ea079223827abe04.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="JHLiveSDK拖入工程"></p>
<p>2、添加系统依赖库</p>
<p><img src="http://upload-images.jianshu.io/upload_images/645301-183452af0541f200.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Link视频传输的系统依赖库"></p>
<p>3、确保Build Settings中’ENABLE_BITCODE’为”NO”</p>
<p><img src="http://upload-images.jianshu.io/upload_images/645301-c4763bad2b2458b5.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="设置Bitcode"></p>
<p>4、导入头文件到.pch文件</p>
<p><img src="http://upload-images.jianshu.io/upload_images/645301-3d0d67aecb98a36d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="非导入到.pch不可"></p>
<blockquote>
<h1 id="SDK使用"><a href="#SDK使用" class="headerlink" title="SDK使用"></a>SDK使用</h1></blockquote>
<p>1、App启动时选择独立模式Or托管模式注册JHLiveSDK</p>
<p><img src="http://upload-images.jianshu.io/upload_images/645301-dd03bfb7eb8db558.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="应用启动时注册JHLiveSDK"></p>
<p>2、到此为止，JHLiveSDK集成完毕，编译程序，查看控制台打印</p>
<p><img src="http://upload-images.jianshu.io/upload_images/645301-bfa736a06ce2fed6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="SDK初始化成功"></p>
<p>3、如果使用自定义UI请无视下面👇的UI集成，当然要使用SDK的具体功能，需要调用登录SDK接口成功后方可进行。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"> *  实例单例</div><div class="line"> */</div><div class="line">+ (instancetype)share;</div><div class="line"></div><div class="line">/**</div><div class="line"> *  注册九合直播</div><div class="line"> */</div><div class="line">-(void)registerJHLive:(AccountType)acountType;</div><div class="line"></div><div class="line">/**</div><div class="line"> *  登录九合直播</div><div class="line"> */</div><div class="line">-(void)loginJHLiveAccount:(NSString*)jhLiveId TlsCode:(NSString*)jhLiveTls Response:(void(^)(BOOL success))loginBlcok;</div><div class="line"></div><div class="line">/**</div><div class="line"> *  开始九合直播</div><div class="line"> */</div><div class="line">-(void)startJHLive:(JHLiveModel*)model RenderView:(UIView*)randerView Response:(void(^)(BOOL success))startBlock;</div><div class="line"></div><div class="line">/**</div><div class="line"> *  结束九合直播</div><div class="line"> */</div><div class="line">-(void)stopJHLive:(void(^)(BOOL success))stopBlock;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/09/函数编程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Carden007">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://static.pexels.com/photos/33392/portrait-bird-nature-wild.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Carden's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/09/函数编程/" itemprop="url">函数编程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-09T12:18:28+08:00">
                2017-06-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://upload-images.jianshu.io/upload_images/4651096-d5076bf6dc5e7170.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<blockquote>
<p>#最终诉求</p>
</blockquote>
<p>整理层次结构，一个理论一个demo，链式编程、响应式编程、RAC内部原理、编程思想、RAC梳理直播逻辑、锻炼头脑、帮助他人、深入浅出、swift基础。</p>
<blockquote>
<p>#Cocoa框架</p>
</blockquote>
<p>面向对象的框架，OC是面向对象的编程，本质上是对于c语言命令式编程的上层封装。</p>
<blockquote>
<p>#函数式编程Vs面向对象编程</p>
</blockquote>
<p>面向对象编程:指令式编程范畴。函数式编程: 语法趋向于数学公式的推导，代码执行顺序不重要，意味着轻松并发编程。响应式编程典型例子：Excel的一个单元格变化导致其它单元格立即变化。Autolayout的父视图frame变化，有约束关系的子视图frame随之变化。一切皆因变量之间存在着函数关系。</p>
<blockquote>
<p>#RAC改写登录注册</p>
</blockquote>
<p>登录service校验用户名和密码、登录按钮不可点击。防止用户多次登录。如果登录失败、用户尝试重新登录、隐藏错误信息。改变按钮状态、接收到next值信号、副作用操作。</p>
<blockquote>
<p>#高阶函数</p>
</blockquote>
<p>函数里面调用函数。在oc中，blocks是被广泛使用的参数传递，它实际上是匿名函数。像linux命令里的pipeline（管道），一个命令调用后的输出当作另一个命令的输入，多个命令串起来操作。</p>
<blockquote>
<p>#链式编程</p>
</blockquote>
<p>返回相同类型或子类或其它类就可以链式调用，图灵等价，语言是基于需求的，没有高低之分，变量不变，意味着代码没顺序要求，线程安全，编译器更好优化，不使用变量，要么递归，要么顺推，折叠函数，要来一个比较函数，高阶函数利用，首先写一个Block，高阶函数帮我门生成一个新的函数。链式编程的思想，即将多个操作通过.连接起来，使得可读性更强，是将多个操作（多行代码）通过点号(.)链接在一起成为一句代码,使代码可读性好。a(1).b(2).c(3)。特点：方法的返回值是block,block必须有返回值（本身对象），block参数（需要操作的值）。代表：masonry框架。在swift中提供了包括map、filter、reduce等十分简洁优秀的高阶函数供我们对数组数据进行操作，同样情况下，遍历一个数组并求和在使用oc（不使用kvc）和swift的环境下的代码是这样的。无论是代码量还是简洁性，此时的oc都比不上swift。那么接下来就要通过神奇的block来为oc添加这些高阶函数的实现</p>
<blockquote>
<p>#函数式编程</p>
</blockquote>
<p>是把操作尽量写成一系列嵌套的函数或者方法调用。代表：ReactiveCocoa。特点：每个方法必须有返回值（本身对象）,把函数或者Block当做参数,block参数（需要操作的值）block返回值（操作结果）</p>
<blockquote>
<p>#函数响应式编程(Functional Reactive Programming:FRP)</p>
</blockquote>
<p>本质通过数据流表达应用功能。关注改变状态值的行为事件，这一系列事件组成了事件流。类似于OC的观察者设计模式。命令式编程语言中，a: = b + c 表示 a 是 b + c 表达式的值。但在RP语言中，表示动态数据流关系：只要c或b的值发生变化，a的值自动跟着变化。不需使用实例变量追踪瞬时状态，新输入值到达，函数立即根据最新输入值计算产生新输出值。</p>
<blockquote>
<p>#ReactiveCocoa优点</p>
</blockquote>
<p>函数响应式编程（FRP）框架。ReactiveCocoa为事件提供了很多处理方法，处理事件很方便，可以把要处理的事情，和监听的事情的代码放在一起，这样非常方便我们管理，就不需要跳到对应的方法里。非常符合我们开发中高聚合，低耦合的思想。使用RAC解决问题，不需考虑调用顺序，直接考虑结果，把原本分离的操作写成嵌套进一起，使代码高聚合，方便管理。</p>
<blockquote>
<p>#RACSignal</p>
</blockquote>
<p>简介：ReactiveCocoa signal（RACSignal）信号源发送信号给它的subscriber订阅者。主要发送三种信号：next值信号、error错误信号、completed结束信号。不同信号进入订阅者不同Block代码块。UIKit控件使用RAC框架的类别即可将空间的事件回调变成信号发送。原本是响应事件，现在是订阅信号。</p>
<ul>
<li><p>创建单元信号：RACSignal类方法创建单元信号对象。</p>
</li>
<li><p>创建动态信号：Block作为形参把信号订阅后需要执行的系列任务记录下来，传入RACSignal的类方法创建动态信号。形参Block的输入值就是订阅者RACSubscriber，意味着只要信号被订阅就可以执行Block里面的操作。</p>
</li>
<li><p>Cocoa桥接：RAC将Cocoa框架中的断点、事件、触发转变成信号，简直棒到没朋友！程序开始调用某方法时发送信号、控件接收到手势触发事件时发送信号、控件的特定属性发生改变时发送信号。所发送信号的值绑定到属性上。</p>
</li>
<li><p>信号变换：常见需求，当我订阅了信号并接收到信号的值，但是信号值与期望值还有点距离，那么必不可少的就是信号变换，本质上就是变换信号的值。</p>
</li>
<li><p>序列转换：sequence是个什么鬼，为啥sequence的signal属性就是序列装换？序列装换有啥用呀？</p>
</li>
<li><p>信号订阅：控件的手势触发、指定方法开始调用都会发出信号</p>
</li>
</ul>
<blockquote>
<p>RACDisposable</p>
</blockquote>
<p>类方法disposableWithBlock、销毁RACSignal信号对象、形参Block代码块封装信号的订阅者消失后所需要执行的代码（取消观察者Or取消代理）</p>
<blockquote>
<p>信号的订阅者消失</p>
</blockquote>
<p>订阅者发送error信号、订阅者发送Completed信号、订阅者的生命周期调用了dealloc</p>
<blockquote>
<p>SubscribeNext方法的内部实现逻辑</p>
</blockquote>
<p>创建订阅者subscriber(代号007)、订阅者保存Block形参、Block代码块就是从更大的一段代码块中抽离出来、订阅者要做的事情就是决定什么地方执行这个代码块</p>
<blockquote>
<p>RACCompoundDisposable</p>
</blockquote>
<p>RACDisposable的子类、方法addDisposable添加RACDisposable、block块执行清理操作</p>
<blockquote>
<p>单个信号变换</p>
</blockquote>
<p>值，数量，维度，时间间隔</p>
<blockquote>
<p>改变信号的值</p>
</blockquote>
<p>Map：遍历每个信号、block改变了next信号的值</p>
<p>Aggregate ：累加、全局变量存储累加值但不符合函数式编程、折叠函数不停向下传递累加值、伪递归不用存储栈里的中间变量</p>
<p>Scan：累加值没更新一次就发送一个新信号</p>
<p>MapReplace：next信号的值通通替换成固定值</p>
<p>ReduceEach：如果next信号的值是元祖、实现元祖的元素内部运算</p>
<blockquote>
<p>改变信号数量</p>
</blockquote>
<p>Take：只要几个信号。顾名思义就是拿的意思，拿什么，当然那信号源A里面的信号，拿几个，当然是自己定。不过注意的是，拿几个信号可不是随便拿，是严格按照信号产生的先后顺序来拿，当然不会拿已经产生很久的信号，肯定是拿最新的信号啦！</p>
<p>Skip：跳过第一个信号不要，顾名思义跳跃，跳跃什么，当然跳过信号啦，跳过最新出现的信号，至于跳过几个最新产生的信号，全屏自己来决定</p>
<p>startWith：增加一个信号。表示给信号源A添加一个自定义的信号，然后注意这个自定义的信号为开头，再组合信号A其它所有的信号，于是这样就组成了信号B。</p>
<p>repeat：循环出现已有的信号、无论什么信号。表示将信号源A里面的所有信号进行不断地重复，这样就是形成了一个新的信号源B，只是这个信号源A里面的信号总共会重复多少次呢，而且如果信号源A在无限循环重复的过程中，出现了新的信号怎么破？</p>
<p>retry：循环出现已有的信号、碰到错误信号重新循环。表示信号A有一个信号，然后来订阅信号源A里面的这个信号，重复订阅的意思，这就迷茫了，不是应该是操作信号源A里面的信号数量么，怎么搞成去订阅信号源A里面的信号了，简直不合常理。</p>
<p>throttle：阀门、重复点击不多次请求</p>
<p>Filter：可以设定条件过滤信号源A中不符合条件的信号，本质就是把信号源A的每个信号里的值都拿出来判断一下，如果这个信号的值满足所设定的判断，那么就把这个信号保留下来变成了信号源B所发的信号</p>
<p>Ignore：可以删除信号源A中指定值的信号。其实本质就是把信号源A发的每一个信号的值都拿出来判断一下，如果判断到从信号中取出的那个值就我所设定的值，那么把这个信号从信号源A中给删除掉，这样就生成了新的信号源B</p>
<p>takeLast：就是去拿信号源A中的最后几个信号</p>
<p>takeUntilBlock：一直去信号源A哪里拿信号直到下一个要拿的信号的值已经我们设定的判断条件</p>
<p>takeWhileBlock：判断信号源A中的每一个信号，哪一个信号的值满足我们设定的条件，我们就是从这个信号以下通通拿走组成一个新的信号源B</p>
<p>skipUntilBlock：本来信号源A一直跳跃，跳过万水千山，一直不肯安定下来，直到发现了真爱，这个真爱就是发现了下一个信号的值刚好满足自己设定的条件，那么自然就是停止跳跃，安定下来，就从这里开始提取信号源A的信号</p>
<p>skipWhileBlock：本来信号源A一直好好的，当判断下一个信号满足什么条件后就开始跳过这个信号，有点类似于判断每一个信号的值，如果下一个信号的值满足我们设定的条件，我们就把它过滤掉的意思，当然这里的官方语言是跳过，跳过和过滤还是有区别的，过滤可能只是过滤掉这一个，但是下一个还是会接着判断的，但是跳跃可就不是这样的了，跳跃意味着以后的信号都不会再处理，直接就结束信号的操作了，被跳跃的信号后面的所有信号都将不再存在。</p>
<p>any和All：属于混合操作，意思就是信号源A中信号每一个信号都需要来一次判断，只有满足多个复合条件的信号才留下，否则其它通通不留。这样也会生成新的信号源B</p>
<blockquote>
<p>多个信号的组合</p>
</blockquote>
<p>Contact：连接</p>
<p>Merge：组合，考虑分线程</p>
<p>Zip：拉链，信号源1和信号源2交替组成新的信号</p>
<p>CombineLatest：两个信号源的最后值结合组成新信号</p>
<p>Sample：采样，采集对方信号的最后一个值</p>
<p>TakeUntil：控制信号去停止另一个信号</p>
<blockquote>
<p>RACSubject</p>
</blockquote>
<p>冷信号？</p>
<p>本地下载点播，每次从头播放。不论订阅者时间先后订阅到的内容相同</p>
<p>热信号？</p>
<p>电视直播，可能中途开始，订阅者角度，主动启动，被动接收。订阅者订阅到的内容严格与时间相关</p>
<blockquote>
<p>RACSignal和RACSubject比较</p>
<p>RACScheduler</p>
</blockquote>
<p>异步库、实现异步、CPU来回调度兼顾多个任务、过度使用优先级万一整出两个第一名咋整、</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div><div class="line">495</div><div class="line">496</div><div class="line">497</div><div class="line">498</div><div class="line">499</div><div class="line">500</div><div class="line">501</div><div class="line">502</div><div class="line">503</div><div class="line">504</div><div class="line">505</div><div class="line">506</div><div class="line">507</div><div class="line">508</div><div class="line">509</div><div class="line">510</div><div class="line">511</div><div class="line">512</div><div class="line">513</div><div class="line">514</div><div class="line">515</div><div class="line">516</div><div class="line">517</div><div class="line">518</div><div class="line">519</div><div class="line">520</div><div class="line">521</div><div class="line">522</div><div class="line">523</div><div class="line">524</div><div class="line">525</div><div class="line">526</div><div class="line">527</div><div class="line">528</div><div class="line">529</div><div class="line">530</div><div class="line">531</div><div class="line">532</div><div class="line">533</div><div class="line">534</div><div class="line">535</div><div class="line">536</div><div class="line">537</div><div class="line">538</div><div class="line">539</div><div class="line">540</div><div class="line">541</div><div class="line">542</div><div class="line">543</div><div class="line">544</div><div class="line">545</div><div class="line">546</div><div class="line">547</div><div class="line">548</div><div class="line">549</div><div class="line">550</div><div class="line">551</div><div class="line">552</div><div class="line">553</div><div class="line">554</div><div class="line">555</div><div class="line">556</div><div class="line">557</div><div class="line">558</div><div class="line">559</div><div class="line">560</div><div class="line">561</div><div class="line">562</div><div class="line">563</div><div class="line">564</div><div class="line">565</div><div class="line">566</div><div class="line">567</div><div class="line">568</div><div class="line">569</div><div class="line">570</div><div class="line">571</div><div class="line">572</div><div class="line">573</div><div class="line">574</div><div class="line">575</div><div class="line">576</div><div class="line">577</div><div class="line">578</div><div class="line">579</div><div class="line">580</div><div class="line">581</div><div class="line">582</div><div class="line">583</div><div class="line">584</div><div class="line">585</div><div class="line">586</div><div class="line">587</div><div class="line">588</div><div class="line">589</div><div class="line">590</div><div class="line">591</div><div class="line">592</div><div class="line">593</div><div class="line">594</div><div class="line">595</div><div class="line">596</div><div class="line">597</div><div class="line">598</div><div class="line">599</div><div class="line">600</div><div class="line">601</div><div class="line">602</div><div class="line">603</div><div class="line">604</div><div class="line">605</div><div class="line">606</div><div class="line">607</div><div class="line">608</div><div class="line">609</div><div class="line">610</div><div class="line">611</div><div class="line">612</div><div class="line">613</div><div class="line">614</div><div class="line">615</div><div class="line">616</div><div class="line">617</div><div class="line">618</div><div class="line">619</div><div class="line">620</div><div class="line">621</div><div class="line">622</div><div class="line">623</div><div class="line">624</div><div class="line">625</div><div class="line">626</div><div class="line">627</div><div class="line">628</div><div class="line">629</div><div class="line">630</div><div class="line">631</div><div class="line">632</div><div class="line">633</div><div class="line">634</div><div class="line">635</div><div class="line">636</div><div class="line">637</div><div class="line">638</div><div class="line">639</div><div class="line">640</div><div class="line">641</div><div class="line">642</div><div class="line">643</div><div class="line">644</div><div class="line">645</div><div class="line">646</div><div class="line">647</div><div class="line">648</div><div class="line">649</div><div class="line">650</div><div class="line">651</div><div class="line">652</div><div class="line">653</div><div class="line">654</div><div class="line">655</div><div class="line">656</div><div class="line">657</div><div class="line">658</div><div class="line">659</div><div class="line">660</div><div class="line">661</div><div class="line">662</div><div class="line">663</div><div class="line">664</div><div class="line">665</div><div class="line">666</div><div class="line">667</div><div class="line">668</div><div class="line">669</div><div class="line">670</div><div class="line">671</div><div class="line">672</div><div class="line">673</div><div class="line">674</div><div class="line">675</div><div class="line">676</div><div class="line">677</div><div class="line">678</div><div class="line">679</div><div class="line">680</div><div class="line">681</div><div class="line">682</div><div class="line">683</div><div class="line">684</div><div class="line">685</div><div class="line">686</div><div class="line">687</div><div class="line">688</div><div class="line">689</div><div class="line">690</div><div class="line">691</div><div class="line">692</div><div class="line">693</div><div class="line">694</div><div class="line">695</div><div class="line">696</div><div class="line">697</div><div class="line">698</div><div class="line">699</div><div class="line">700</div><div class="line">701</div><div class="line">702</div><div class="line">703</div><div class="line">704</div><div class="line">705</div><div class="line">706</div><div class="line">707</div><div class="line">708</div><div class="line">709</div><div class="line">710</div><div class="line">711</div><div class="line">712</div><div class="line">713</div><div class="line">714</div><div class="line">715</div><div class="line">716</div><div class="line">717</div><div class="line">718</div><div class="line">719</div><div class="line">720</div><div class="line">721</div><div class="line">722</div><div class="line">723</div><div class="line">724</div><div class="line">725</div><div class="line">726</div><div class="line">727</div><div class="line">728</div><div class="line">729</div><div class="line">730</div><div class="line">731</div><div class="line">732</div><div class="line">733</div><div class="line">734</div><div class="line">735</div><div class="line">736</div><div class="line">737</div><div class="line">738</div><div class="line">739</div><div class="line">740</div><div class="line">741</div><div class="line">742</div><div class="line">743</div><div class="line">744</div><div class="line">745</div><div class="line">746</div><div class="line">747</div><div class="line">748</div><div class="line">749</div><div class="line">750</div><div class="line">751</div><div class="line">752</div><div class="line">753</div><div class="line">754</div><div class="line">755</div><div class="line">756</div><div class="line">757</div><div class="line">758</div><div class="line">759</div><div class="line">760</div><div class="line">761</div><div class="line">762</div><div class="line">763</div><div class="line">764</div><div class="line">765</div><div class="line">766</div><div class="line">767</div><div class="line">768</div><div class="line">769</div><div class="line">770</div><div class="line">771</div><div class="line">772</div><div class="line">773</div><div class="line">774</div><div class="line">775</div><div class="line">776</div><div class="line">777</div><div class="line">778</div><div class="line">779</div><div class="line">780</div><div class="line">781</div><div class="line">782</div><div class="line">783</div><div class="line">784</div><div class="line">785</div><div class="line">786</div><div class="line">787</div><div class="line">788</div><div class="line">789</div><div class="line">790</div><div class="line">791</div><div class="line">792</div><div class="line">793</div><div class="line">794</div><div class="line">795</div><div class="line">796</div><div class="line">797</div><div class="line">798</div><div class="line">799</div><div class="line">800</div><div class="line">801</div><div class="line">802</div><div class="line">803</div><div class="line">804</div><div class="line">805</div><div class="line">806</div><div class="line">807</div><div class="line">808</div><div class="line">809</div><div class="line">810</div><div class="line">811</div><div class="line">812</div><div class="line">813</div><div class="line">814</div><div class="line">815</div><div class="line">816</div><div class="line">817</div><div class="line">818</div><div class="line">819</div><div class="line">820</div><div class="line">821</div><div class="line">822</div><div class="line">823</div><div class="line">824</div><div class="line">825</div><div class="line">826</div><div class="line">827</div><div class="line">828</div><div class="line">829</div><div class="line">830</div><div class="line">831</div><div class="line">832</div><div class="line">833</div><div class="line">834</div><div class="line">835</div><div class="line">836</div><div class="line">837</div><div class="line">838</div><div class="line">839</div><div class="line">840</div><div class="line">841</div><div class="line">842</div><div class="line">843</div><div class="line">844</div><div class="line">845</div><div class="line">846</div><div class="line">847</div><div class="line">848</div><div class="line">849</div><div class="line">850</div><div class="line">851</div><div class="line">852</div><div class="line">853</div><div class="line">854</div><div class="line">855</div><div class="line">856</div><div class="line">857</div><div class="line">858</div><div class="line">859</div><div class="line">860</div><div class="line">861</div><div class="line">862</div><div class="line">863</div><div class="line">864</div><div class="line">865</div><div class="line">866</div><div class="line">867</div><div class="line">868</div><div class="line">869</div><div class="line">870</div><div class="line">871</div><div class="line">872</div><div class="line">873</div><div class="line">874</div><div class="line">875</div><div class="line">876</div><div class="line">877</div><div class="line">878</div><div class="line">879</div><div class="line">880</div><div class="line">881</div><div class="line">882</div><div class="line">883</div><div class="line">884</div><div class="line">885</div><div class="line">886</div><div class="line">887</div><div class="line">888</div><div class="line">889</div><div class="line">890</div><div class="line">891</div><div class="line">892</div><div class="line">893</div><div class="line">894</div><div class="line">895</div><div class="line">896</div><div class="line">897</div><div class="line">898</div><div class="line">899</div><div class="line">900</div><div class="line">901</div><div class="line">902</div><div class="line">903</div><div class="line">904</div><div class="line">905</div><div class="line">906</div><div class="line">907</div><div class="line">908</div><div class="line">909</div><div class="line">910</div><div class="line">911</div><div class="line">912</div><div class="line">913</div><div class="line">914</div></pre></td><td class="code"><pre><div class="line">//创建单元信号（next值事件）</div><div class="line">RACSignal *signal1 = [RACSignal return:@&quot;Some Value&quot;];</div><div class="line">//创建单元信号（error错误事件）</div><div class="line">RACSignal *signal2 = [RACSignal error:errorObject];</div><div class="line">//创建单元信号（empty空事件）</div><div class="line">RACSignal *signal3 = [RACSignal empty];</div><div class="line">//创建单元信号（never永远事件）</div><div class="line">RACSignal *signal4 = [RACSignal never];</div><div class="line">//创建动态信号</div><div class="line">RACSignal *signal5 = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">    [subscriber sendNext:@1];</div><div class="line">    [subscriber sendNext:@2];</div><div class="line">    [subscriber sendError:errorObject];</div><div class="line">    [subscriber sendCompleted];</div><div class="line">    return [RACDisposable disposableWithBlock:^&#123;</div><div class="line"></div><div class="line">    &#125;];</div><div class="line">&#125;];</div><div class="line">//创建方法监听信号</div><div class="line">RACSignal *signal6 = [view rac_signalForSelector:@selector(setFrame:)];</div><div class="line">//创建点击事件信号</div><div class="line">RACSignal *signal7 = [view rac_signalForControlEvents:UIControlEventTouchUpInside];</div><div class="line">//创建销毁事件信号</div><div class="line">RACSignal *signal8 = [view rac_willDeallocSignal];</div><div class="line">//创建控件属性信号</div><div class="line">RACSignal *signal9 = RACObserve(view, backgroundColor);</div><div class="line">//编辑旧信号返回新信号</div><div class="line">RACSignal *signal10 = [signal1 map:^id(NSString *value) &#123;</div><div class="line">   return [value substringFromIndex:1];</div><div class="line">&#125;];</div><div class="line">//序列转换</div><div class="line">RACSignal *signal11 = sequence.signal;</div><div class="line">//订阅一个信号</div><div class="line">[signal11 subscribeNext:^(id x) &#123;</div><div class="line">    NSLog(@&quot;next value is %@&quot;, x);</div><div class="line">&#125; error:^(NSError *error) &#123;</div><div class="line">    NSLog(@&quot;Ops! Get some error: %@&quot;, error);</div><div class="line">&#125; completed:^&#123;</div><div class="line">    NSLog(@&quot;It finished success&quot;);</div><div class="line">&#125;];</div><div class="line">//绑定</div><div class="line">RAC(view, backgroundColor) = signal10;</div><div class="line">[view rac_liftSelector:@selector(convertPoint:toView:) withSignals:signal1, signal2, nil];</div><div class="line">[view rac_liftSelector:@selector(convertRect:toView:)  withSignalsFromArray:@[signal3, signal4]];</div><div class="line">[view rac_liftSelector:@selector(convertRect:toLayer:) withSignalOfArguments:signal5];</div><div class="line">//订阅过程</div><div class="line">RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber)&#123;</div><div class="line">    [subscriber sendNext:@1];</div><div class="line">    [subscriber sendNext:@2];</div><div class="line">    [subscriber sendCompleted];</div><div class="line">    return [RACDisposable disposableWithBlock:^&#123;</div><div class="line">        NSLog(@&quot;dispose&quot;);</div><div class="line">    &#125;];</div><div class="line">&#125;];</div><div class="line">//手动取消订阅，即使订阅者没有被销毁，仍然可以取消该信号</div><div class="line">RACDisposable *disposable = [signal subscribeNext:^(id x) &#123;</div><div class="line">    NSLog(@&quot;next value is %@&quot;, x);</div><div class="line">&#125; error:^(NSError *error) &#123;</div><div class="line">    NSLog(@&quot;Ops! Get some error: %@&quot;, error);</div><div class="line">&#125; completed:^&#123;</div><div class="line">    NSLog(@&quot;It finished success&quot;);</div><div class="line">&#125;];</div><div class="line">[disposable dispose];</div><div class="line">//元组RACTuple</div><div class="line">RACTuple * tuple = RACTuplePack(@1, @&quot;haha&quot;);</div><div class="line">id first  = tuple.first;</div><div class="line">id second = tuple.second;</div><div class="line">id last   = tuple.last;</div><div class="line">id index1 = tuple[1];</div><div class="line">RACTupleUnpack(NSNumber *num, NSString *str) = tuple;</div><div class="line">//值操作——Map</div><div class="line">RACSignal *signalB = [signalA map:^id(NSNumber *value) &#123;</div><div class="line">   return @(value.integerValue * 2);</div><div class="line">&#125;];</div><div class="line">//值操作——ReduceEach:</div><div class="line">RACSignal *signalB = [signalA reduceEach:^id(NSNumber *first,NSNumber *second) &#123;</div><div class="line">   return @(first.integerValue + second.integerValue);</div><div class="line">&#125;];</div><div class="line">//数量操作——Filter</div><div class="line">RACSignal *signalB = [signalA filter:^BOOL(NSString *value) &#123;</div><div class="line">   return value.length &gt; 2;</div><div class="line">&#125;];</div><div class="line">//数量操作——Ignore</div><div class="line">RACSignal *signalB = [signalA filter:^BOOL(id value) &#123;</div><div class="line">   return ![@1 isEqual:value];</div><div class="line">&#125;];</div><div class="line">RACSignal *signalC = [signalA ignore:@1];</div><div class="line">- (RACSignal *)ignoreValues;</div><div class="line">- (RACSignal *)distinctUntilChanged;</div><div class="line">//数量操作——Take</div><div class="line">RACSignal *signalB = [signalA take:2];</div><div class="line">//数量操作——Skip</div><div class="line">RACSignal *signalB = [signalA skip:1];</div><div class="line">//数量操作——Take&amp;Skip其他</div><div class="line">- (RACSignal *)takeLast:(NSUInteger)count;</div><div class="line">- (RACSignal *)takeUntilBlock:(BOOL (^)(id x))predicate;</div><div class="line">- (RACSignal *)takeWhileBlock:(BOOL (^)(id x))predicate;</div><div class="line">- (RACSignal *)skipUntilBlock:(BOOL (^)(id x))predicate;</div><div class="line">- (RACSignal *)skipWhileBlock:(BOOL (^)(id x))predicate;</div><div class="line">//数量混合操作</div><div class="line">- (RACSignal *)any;</div><div class="line">- (RACSignal *)any:(BOOL (^)(id object))predicateBlock;</div><div class="line">- (RACSignal *)all:(BOOL (^)(id object))predicateBlock;</div><div class="line">//数量操作——StartWith</div><div class="line">RACSignal *signalB = [signalA startWith:@&quot;Start&quot;];</div><div class="line">//数量操作——Repeat</div><div class="line">RACSignal *signalB = [signalA repeat];</div><div class="line">//数量操作——Retry,如果订阅都到了错误事件，重头开始订阅</div><div class="line">RACSignal *signalB = [signalA retry:2];</div><div class="line">//副作用操作--就是没有改变任何变量的值的操作</div><div class="line">RACSignal *signalB = [signalA map:^id(id value) &#123;</div><div class="line">   return value;</div><div class="line">&#125;];</div><div class="line">RACSignal *signalC = [signalA doNext:^(id x) &#123;</div><div class="line">   do some thing;</div><div class="line">&#125;];</div><div class="line">- (RACSignal *)doError:(void (^)(NSError *error))block;</div><div class="line">- (RACSignal *)doCompleted:(void (^)(void))block;</div><div class="line">- (RACSignal *)initially:(void (^)(void))block;</div><div class="line">- (RACSignal *)finally:(void (^)(void))block;</div><div class="line">//数量操作——Collect</div><div class="line">RACSignal *signalB = [signalA collect];</div><div class="line">//数量操作——Aggregate</div><div class="line">typedef int(^FoldFunction)(int running, int next);</div><div class="line">int fold(int *array, int count, FoldFunction func, int start)&#123;</div><div class="line">    int current = array[0];</div><div class="line">    int running = func(start, current);</div><div class="line">    if (count == 1) return running;;</div><div class="line">    return fold(array + 1, count - 1, func, running);</div><div class="line">&#125;</div><div class="line">    int arr[] = &#123;1, 2, 3, 4, 5&#125;;</div><div class="line">    int result = fold(arr, 5, ^int(int running, int next) &#123;</div><div class="line">    return running + next;</div><div class="line">&#125;, 0);</div><div class="line">//数量操作——Aggregate</div><div class="line">RACSignal *signalB = [signalA aggregateWithStart:@0 reduce:^id(NSNumber *running,NSNumber *next) &#123;</div><div class="line">     return @(running.integerValue + next.integerValue);</div><div class="line">&#125;];</div><div class="line">//值操作——Scan</div><div class="line">RACSignal *signalB = [signalA scanWithStart:@0 reduce:^id(NSNumber *running,NSNumber *next) &#123;</div><div class="line">    return @(running.integerValue + next.integerValue);</div><div class="line">&#125;];</div><div class="line">//Aggregate&amp;Scan变种</div><div class="line">- (RACSignal *)aggregateWithStart:(id)start reduceWithIndex:(id (^)(id running,id next,NSUInteger index))reduceBlock;</div><div class="line">- (RACSignal *)aggregateWithStartFactory:(id (^)(void))startFactory reduce:(id (^)(id running,id next))reduceBlock;</div><div class="line">- (RACSignal *)scanWithStart:(id)startingValue reduceWithIndex:(id (^)(id running,id next,NSUInteger index))reduceBlock;</div><div class="line">//无限递增信号、斐波那契数列信号</div><div class="line">RACSignal *repeat1 = [[RACSignal return:@1] repeat];</div><div class="line">RACSignal *signalB = [repeat1 scanWithStart:@0 reduce:^id(NSNumber *running,NSNumber *next) &#123;</div><div class="line">    return @(running.integerValue + next.integerValue);</div><div class="line">&#125;];</div><div class="line">RACSignal *signalC = [repeat1 scanWithStart:RACTuplePack(@1, @1) reduce:^id(RACTuple *running, id _) &#123;</div><div class="line">    NSNumber *next = @([running.first integerValue] + [running.second integerValue]);</div><div class="line">    return RACTuplePack(running.second, next);</div><div class="line">&#125;];</div><div class="line">//时间操作——有用的信号</div><div class="line">+ (RACSignal *)interval:(NSTimeInterval)interval onScheduler:(RACScheduler *)scheduler;</div><div class="line">+ (RACSignal *)interval:(NSTimeInterval)interval onScheduler:(RACScheduler *)scheduler  withLeeway:(NSTimeInterval)leeway;</div><div class="line">//时间操作——Delay</div><div class="line">RACSignal *signalB = [signalA delay:1];</div><div class="line">RACSignal *interval = [[[RACSignal return:@1] delay:1] repeat];</div><div class="line">//时间操作——Throttle</div><div class="line">RACSignal *signalB = [signalA throttle:2];</div><div class="line">//时间操作——类似Throttle的方法</div><div class="line">- (RACSignal *)throttle:(NSTimeInterval)interval valuesPassingTest:(BOOL (^)(id next))predicate;</div><div class="line">- (RACSignal *)bufferWithTime:(NSTimeInterval)interval onScheduler:(RACScheduler *)scheduler;</div><div class="line">//组合操作——Concat皇帝和太子，谁发号施令</div><div class="line">RACSignal *signalC = [signalA concat:signalB];</div><div class="line">//组合操作——Merge</div><div class="line">RACSignal *signalC = [signalA merge:signalB];</div><div class="line">RACSignal *signalC = [RACSignal merge:@[signalA, signalB]];</div><div class="line">RACSignal *signalC = [RACSignal merge:RACTuplePack(signalA, signalB)];</div><div class="line">//Merge综合应用</div><div class="line">RACSignal *appearSignal = [[self rac_signalForSelector:@selector(viewDidAppear:)]</div><div class="line">mapReplace:@YES];</div><div class="line">RACSignal *disappearSignal = [[self rac_signalForSelector:@selector(viewWillDisappear:)]</div><div class="line">mapReplace:@NO];</div><div class="line">RACSignal *activeSignal = [RACSignal merge:@[appearSignal, disappearSignal]];</div><div class="line">//组合操作——Zip夫妻决定一件事情必须双方都同意,各拿一个值事件组成元祖，不能重复拿值事件</div><div class="line">RACSignal *signalC = [signalA zipWith:signalB];</div><div class="line">RACSignal *signalC = [RACSignal zip:@[signalA, signalB]];</div><div class="line">RACSignal *signalC = [RACSignal zip:RACTuplePack(signalA, signalB)];</div><div class="line">//组合操作——CombineLatest各拿一个最新值事件组成一个元祖</div><div class="line">RACSignal *signalC = [signalA combineLatestWith:signalB];</div><div class="line">RACSignal *signalC = [RACSignal combineLatest:@[signalA, signalB]];</div><div class="line">组合操作——Zip&amp;CombineLatest更多操作</div><div class="line">+ (RACSignal *)combineLatest:(id&lt;NSFastEnumeration&gt;)signals reduce:(id (^)())reduceBlock;</div><div class="line">+ (RACSignal *)zip:(id&lt;NSFastEnumeration&gt;)streams reduce:(id (^)())reduceBlock;</div><div class="line">//组合操作——Sample用B接收A最近的值事件</div><div class="line">RACSignal *signalC = [signalA sample:signalB];</div><div class="line">//组合操作——TakeUntil</div><div class="line">RACSignal *signalC = [signalA takeUntil:signalB];</div><div class="line">//组合操作——TakeUntilReplacement</div><div class="line">RACSignal *signalC = [signalA takeUntilReplacement:signalB];</div><div class="line">ReactiveCocoa之冷信号与热信号</div><div class="line">//冷热信号转换本质</div><div class="line">    return [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">        RACStreamBindBlock bindBlock = block();</div><div class="line">        [self subscribeNext:^(id x) &#123;</div><div class="line">        BOOL stop = NO;</div><div class="line">        RACSignal *signal = (RACSignal *)bindBlock(x, &amp;stop);</div><div class="line">        if (signal == nil || stop) &#123; [subscriber sendCompleted];</div><div class="line">        &#125; else &#123;</div><div class="line">        [signal subscribeNext:^(id x) &#123; [subscriber sendNext:x];</div><div class="line">        &#125; error:^(NSError *error) &#123; [subscriber sendError:error];</div><div class="line">        &#125; completed:^&#123; &#125;];</div><div class="line">        &#125;</div><div class="line">        &#125; error:^(NSError *error) &#123; [subscriber sendError:error];</div><div class="line">        &#125; completed:^&#123; [subscriber sendCompleted]; &#125;];</div><div class="line">        return nil;</div><div class="line">    &#125;];</div><div class="line">&#125;</div><div class="line">//热信号RACSubject</div><div class="line">RACSubject *subject = [RACSubject subject];</div><div class="line">[subject subscribeNext:^(id x) &#123;&#125; error:^(NSError *error) &#123;&#125; completed:^&#123;&#125;];</div><div class="line">[subject sendNext:@1];</div><div class="line">[subject sendNext:@2];</div><div class="line">[subject sendNext:@3];</div><div class="line">[subject sendCompleted];</div><div class="line">//RACReplaySubject带快速回播的Subject</div><div class="line">RACReplaySubject *subject = [RACReplaySubject replaySubjectWithCapacity:1];</div><div class="line">[subject sendNext:@1];</div><div class="line">[subject sendNext:@2];</div><div class="line">[subject sendCompleted];</div><div class="line">[subject subscribeNext:^(id x) &#123;  /* a*/  &#125;];</div><div class="line">//冷信号 -&gt; 热信号:RACSubject有权对从RACSignal哪里订阅到的值事件做分发和处理</div><div class="line">RACSignal *signal = @[@1, @2, @3, @4].rac_sequence.signal;</div><div class="line">RACSignal *signalB = [[signal map:^id(id value) &#123;</div><div class="line">return [[RACSignal return:value] delay:1];</div><div class="line">&#125;] concat];</div><div class="line">RACSubject *speaker = [RACSubject subject];</div><div class="line">[signalB subscribe:speaker];</div><div class="line">[speaker subscribeNext:^(id x) &#123;  // a &#125;];</div><div class="line">[speaker subscribeNext:^(id x) &#123;  // b &#125;];</div><div class="line">[speaker subscribeNext:^(id x) &#123;  // c &#125;];</div><div class="line">//冷信号 -&gt; 热信号 官方方案</div><div class="line">- (RACMulticastConnection *)publish;</div><div class="line">- (RACMulticastConnection *)multicast:(RACSubject *)subject;</div><div class="line">- (RACSignal *)replay;</div><div class="line">- (RACSignal *)replayLast;</div><div class="line">- (RACSignal *)replayLazily;</div><div class="line">//冷信号+副作用方法</div><div class="line">+ (RACSignal *)defer:(RACSignal * (^)(void))block;</div><div class="line">- (RACSignal *)then:(RACSignal * (^)(void))block;</div><div class="line">//不建议使用的同步方法</div><div class="line">- (id)first;</div><div class="line">- (id)firstOrDefault:(id)defaultValue;</div><div class="line">- (id)firstOrDefault:(id)defaultValue success:(BOOL *)success error:(NSError **)error;</div><div class="line">- (BOOL)waitUntilCompleted:(NSError **)error;</div><div class="line">- (NSArray *)toArray;</div><div class="line">@property (nonatomic, strong, readonly) RACSequence *sequence;</div><div class="line">//groupBy很多个普通值事件的信号变成包含两个信号值事件的高阶信号</div><div class="line">- (RACSignal *)groupBy:(id&lt;NSCopying&gt; (^)(id object))keyBlock;</div><div class="line">- (RACSignal *)groupBy:(id&lt;NSCopying&gt; (^)(id object))keyBlock transform:(id (^)(id object))transformBlock;</div><div class="line">RACSignal *signal = @[@1, @2, @3, @4].rac_sequence.signal;</div><div class="line">RACSignal *signalGroup = [signal groupBy:^NSString *(NSNumber *object) &#123;</div><div class="line">    return object.integerValue % 2 == 0 ? @&quot;odd&quot; : @&quot;even&quot;;</div><div class="line">&#125;];</div><div class="line">[[[signalGroup take:1] flatten] subscribeNext:^(id x) &#123;</div><div class="line">    NSLog(@&quot;next: %@&quot;, x);</div><div class="line">&#125;];</div><div class="line">同步:方法或函数不返回结果不进行下一步,事无巨细，亲力亲为</div><div class="line">异步:分身有术</div><div class="line">并发:统筹兼顾</div><div class="line">并行:专人专事</div><div class="line">// 主线程的Scheduler</div><div class="line">RACScheduler *mainScheduler = [RACScheduler mainThreadScheduler];</div><div class="line">// 子线程的Scheduler</div><div class="line">RACScheduler *scheduler2 = [RACScheduler scheduler];</div><div class="line">// 返回当前的Scheduler</div><div class="line">RACScheduler *scheduler3 = [RACScheduler currentScheduler];</div><div class="line">// 设置Scheduler的优先级,注意两个都是老子天下第一</div><div class="line">RACScheduler *scheduler4 = [RACScheduler schedulerWithPriority:RACSchedulerPriorityHigh];</div><div class="line">RACScheduler *scheduler5 = [RACScheduler schedulerWithPriority:RACSchedulerPriorityHigh name:@&quot;someName&quot;];</div><div class="line">// 创建立即的Scheduler</div><div class="line">RACScheduler  *scheduler6 = [RACScheduler immediateScheduler];</div><div class="line">// 调度程序在mainScheduler里面执行任务，同时可以随时取消任务的执行</div><div class="line">RACDisposable *disposable = [mainScheduler schedule:^&#123; /* </div><div class="line">// 时间之后调度程序在scheduler1里面执行</div><div class="line">NSDateFormatter *formatter = [[NSDateFormatter alloc] init];</div><div class="line">formatter.dateFormat = @&quot;yyyy-MM-dd HH:mm:ss&quot;;</div><div class="line">NSDate *date = [formatter dateFromString:@&quot;2016-07-20 21:00:00&quot;];</div><div class="line">[scheduler1 after:date schedule:^&#123; /* </div><div class="line">// 秒之后调度程序在scheduler2里面执行</div><div class="line">[scheduler2 afterDelay:30 schedule:^&#123; /* </div><div class="line">// 时间之后调度程序在scheduler3里面执行,没隔1秒执行一次，算上允许延迟的0.1秒，执行时间最长1.1秒</div><div class="line">[scheduler3 after:[NSDate date] repeatingEvery:1 withLeeway:0.1 schedule:^&#123;&#125;];</div><div class="line"></div><div class="line"></div><div class="line">RACScheduler vs GCD</div><div class="line">//异步订阅:创建子线程Scheduler执行subscribeNext方法</div><div class="line">[[RACScheduler scheduler] schedule:^&#123;</div><div class="line">    [signal subscribeNext:^(id x) &#123;</div><div class="line">        NSLog(@&quot;333&quot;);</div><div class="line">    &#125;];</div><div class="line">&#125;];</div><div class="line">//异步发送:创建子线程Scheduler执行sendNext方法</div><div class="line">RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">    RACDisposable *disposable = [[RACScheduler scheduler] schedule:^&#123;</div><div class="line">        [subscriber sendNext:@1];</div><div class="line">        [subscriber sendCompleted];</div><div class="line">    &#125;];</div><div class="line">    return disposable;</div><div class="line">&#125;];</div><div class="line">//同步发送在前异步发送在后:subscribeNext的Block代码块先在主线程执行，后在子线程执行</div><div class="line">//一会儿主线程激活subscribeNext一会儿子线程激活subscribeNext，自己的路自己走到底</div><div class="line">RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">    [subscriber sendNext:@0.1];</div><div class="line">    RACDisposable *disposable = [[RACScheduler scheduler] schedule:^&#123;</div><div class="line">        [subscriber sendNext:@1.1];</div><div class="line">        [subscriber sendCompleted];</div><div class="line">    &#125;];</div><div class="line">    return disposable;</div><div class="line">&#125;];</div><div class="line">//订阅和发送都异步:异步高于同步，发送优于订阅</div><div class="line">RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">    [subscriber sendNext:@0.1];</div><div class="line">    RACDisposable *disposable = [[RACScheduler scheduler] schedule:^&#123;</div><div class="line">        [subscriber sendNext:@1.1];</div><div class="line">        [subscriber sendCompleted];</div><div class="line">    &#125;];</div><div class="line">    return disposable;</div><div class="line">&#125;];</div><div class="line">[[RACScheduler scheduler] schedule:^&#123;</div><div class="line">    [signal subscribeNext:^(id x) &#123;</div><div class="line">        NSLog(@&quot;%@&quot;, x);</div><div class="line">    &#125;];</div><div class="line">&#125;];</div><div class="line">//subscribeOn:保证didSubscribe的Block在指定schedule执行,比如说在didSubscribe的Block里执行添加UIKit控件到父视图的代码</div><div class="line">RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">    [subscriber sendNext:@0.1];</div><div class="line">    RACDisposable *disposable = [[RACScheduler scheduler] schedule:^&#123;</div><div class="line">        [subscriber sendNext:@1.1];</div><div class="line">        [subscriber sendCompleted];</div><div class="line">    &#125;];</div><div class="line">    return disposable;</div><div class="line">&#125;];</div><div class="line">[[RACScheduler scheduler] schedule:^&#123;</div><div class="line">    [[signal subscribeOn:[RACScheduler mainThreadScheduler]] subscribeNext:^(id x) &#123;</div><div class="line">        NSLog(@&quot;%@&quot;, x);</div><div class="line">    &#125;];</div><div class="line">&#125;];</div><div class="line">//deliverOn:保证subscribeNext的Block在指定schedule执行</div><div class="line">RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">    [subscriber sendNext:@0.1];</div><div class="line">    RACDisposable *disposable = [[RACScheduler scheduler] schedule:^&#123;</div><div class="line">        [subscriber sendNext:@1.1];</div><div class="line">        [subscriber sendCompleted];</div><div class="line">    &#125;];</div><div class="line">    return disposable;</div><div class="line">&#125;];</div><div class="line">[[RACScheduler scheduler] schedule:^&#123;</div><div class="line">    [[signal deliverOn:[RACScheduler mainThreadScheduler]] subscribeNext:^(id x) &#123;</div><div class="line">        NSLog(@&quot;%@&quot;, x);</div><div class="line">    &#125;];</div><div class="line">&#125;];</div><div class="line">//subscribeOn:的用武之地</div><div class="line">void whenShouldWeUseSubscribeOn()</div><div class="line">&#123;</div><div class="line">UIView *view = [[UIView alloc] init];</div><div class="line">RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">UILabel *label = [[UILabel alloc] init];</div><div class="line">label.text = @&quot;Hello world&quot;;</div><div class="line">[view addSubview:label];</div><div class="line">[subscriber sendNext:@0.1];</div><div class="line">RACDisposable *disposable = [[RACScheduler scheduler] schedule:^&#123;</div><div class="line">[subscriber sendNext:@1.1];</div><div class="line">[subscriber sendCompleted];</div><div class="line">&#125;];</div><div class="line">return disposable;</div><div class="line">&#125;];</div><div class="line">[[RACScheduler scheduler] schedule:^&#123;</div><div class="line">[[signal subscribeOn:[RACScheduler mainThreadScheduler]] subscribeNext:^(id x) &#123;</div><div class="line">NSLog(@&quot;%@&quot;, x);</div><div class="line">&#125;];</div><div class="line">&#125;]; &#125;</div><div class="line"></div><div class="line">ReactiveCocoa之信号高阶操作</div><div class="line"></div><div class="line">//创造高阶信号</div><div class="line">RACSignal *signal = [RACSignal return:@1];</div><div class="line">RACSignal *signalHighOrder = [RACSignal return:signal];</div><div class="line">RACSignal *anotherSignal = [signal map:^id(id value) &#123;</div><div class="line">    return [RACSignal return:value];</div><div class="line">&#125;];</div><div class="line">//订阅高阶信号</div><div class="line">RACSignal *signal = @[@1, @2, @3].rac_sequence.signal;</div><div class="line">RACSignal *highOrderSignal = [signal map:^id(id value) &#123;</div><div class="line">    return [RACSignal return:value];</div><div class="line">&#125;];</div><div class="line">[highOrderSignal subscribeNext:^(RACSignal *aSignal) &#123;</div><div class="line">    [aSignal subscribeNext:^(id x) &#123;</div><div class="line">        // get real value here.</div><div class="line">    &#125;];</div><div class="line">&#125;];</div><div class="line">//降阶操作——SwitchToLatests一旦订阅到新信号的值立马销毁旧信号</div><div class="line">RACSignal *signalB = [signalA switchToLatest]; </div><div class="line">RACSignal *autoRunButtonClickSignal = [self.autoRunBtn rac_signalForControlEvents:UIControlEventTouchUpInside];</div><div class="line">RACSignal *oneStepButtonClickSignal = [self.oneStepBtn rac_signalForControlEvents:UIControlEventTouchUpInside];</div><div class="line">RACSignal *idSignal = [RACSignal return:nil];</div><div class="line">RACSignal *timerSignal = [RACSignal interval:1 onScheduler:[RACScheduler mainThreadScheduler]];</div><div class="line">autoRunButtonClickSignal = [autoRunButtonClickSignal mapReplace:idSignal];</div><div class="line">oneStepButtonClickSignal = [oneStepButtonClickSignal mapReplace:timerSignal];</div><div class="line">RACSignal *controlSignal = [autoRunButtonClickSignal merge:oneStepButtonClickSignal];</div><div class="line">controlSignal = [controlSignal switchToLatest];</div><div class="line">//填词搜索示例，信号事件降阶成值事件，同时一旦处理新的信号事件的值事件，立即结束前一个信号事件</div><div class="line">RACSignal *searchTextSignal = [self.searchTextField rac_textSignal];</div><div class="line">RACSignal *requestSignals = [searchTextSignal map:^id(NSString *searchText) &#123;</div><div class="line">    NSString *urlString = [NSString stringWithFormat:</div><div class="line">    @&quot;http://xxxx.xxx.xxx/?q=%@&quot;, searchText];</div><div class="line">    NSURL *url = [NSURL URLWithString:urlString];</div><div class="line">    NSURLRequest *request = [NSURLRequest requestWithURL:url];</div><div class="line">    return [NSURLConnection rac_sendAsynchronousRequest:request];</div><div class="line">&#125;];</div><div class="line">requestSignals = [requestSignals switchToLatest];</div><div class="line">//降阶操作——If/then/else如果是YES订阅信号A如果是NO订阅信号B的原理就是switchToLatest来实现</div><div class="line">RACSignal *signalB = [RACSignal if: signalA then: signalTrue else: signalFalse]; </div><div class="line">+ (RACSignal *)if:(RACSignal *)boolSignal then:(RACSignal *)trueSignal else:(RACSignal *)falseSignal &#123;</div><div class="line">    return [[boolSignal map:^(NSNumber *value) &#123;</div><div class="line">        return (value.boolValue ? trueSignal : falseSignal);</div><div class="line">    &#125;] switchToLatest];</div><div class="line">&#125;</div><div class="line">+ (RACSignal *)switch:(RACSignal *)signal cases:(NSDictionary *)cases default:(RACSignal *)defaultSignal;</div><div class="line">降阶操作——Flatten按照时间顺序订阅每一个信号的每一个值事件</div><div class="line">RACSignal *signalB = [signalA flatten]; </div><div class="line">RACSignal *signalB = [signalA flatten:2];</div><div class="line">RACSignal *signalB = [signalA flatten:1];</div><div class="line">//高阶信号concat连续方法</div><div class="line">RACSignal *signal = @[@1, @3, @7, @9, @8].rac_sequence.signal;</div><div class="line">RACSignal *timerSignal = [[signal map:^id(id value) &#123;</div><div class="line">    return [[RACSignal return:value] delay:1];</div><div class="line">&#125;] concat];</div><div class="line">//降阶操作总结</div><div class="line">SwitchToLatests</div><div class="line">Flatten(</div><div class="line"></div><div class="line">思考1:改变某个值的个数</div><div class="line">RACSignal *signal = @[@1, @2, @3].rac_sequence.signal;</div><div class="line">RACSignal *mappedSignal = [[signal map:^id(NSNumber *value) &#123;</div><div class="line">    return [[[RACSignal return:value] repeat] take:value.integerValue];</div><div class="line">&#125;] flatten];</div><div class="line">思考2:将一个值改为错误</div><div class="line">RACSignal *signal = @[@1, @2, @3, @0].rac_sequence.signal;</div><div class="line">RACSignal *mappedSignal = [[signal map:^id(NSNumber *value) &#123;</div><div class="line">    if (value.integerValue == 0) &#123;</div><div class="line">        return [RACSignal error:[NSError errorWithDomain:@&quot;0&quot; code:0 userInfo:nil]];</div><div class="line">    &#125;else &#123;</div><div class="line">        return [RACSignal return:value];</div><div class="line">    &#125;</div><div class="line">&#125;] flatten];</div><div class="line">思考3:改变值的时间间隔</div><div class="line">RACSignal *signal = @[@&quot;♪5&quot;, @&quot;♬1&quot;, @&quot;♬2&quot;, @&quot;♬3&quot;, @&quot;♩4&quot;].rac_sequence.signal;</div><div class="line">NSDictionary *toneLengthMap = @&#123;@&quot;♩&quot;: @0.5, @&quot;♪&quot;: @0.25, @&quot;♬&quot;: @0.125&#125;;</div><div class="line">RACSignal *mappedSignal = [[signal map:^id(NSString *value) &#123;</div><div class="line">    NSString *tone = [value substringFromIndex:1];</div><div class="line">    NSString *length = [value substringToIndex:1];</div><div class="line">    NSNumber *toneValue = @(tone.integerValue);</div><div class="line">    NSNumber *toneLength = toneLengthMap[length];</div><div class="line">    return [[RACSignal return:toneValue] concat:[[RACSignal empty] delay: toneLength.doubleValue]];</div><div class="line">&#125;] concat];</div><div class="line">修改每一个普通值事件成为信号值事件，然后执行信号值事件的信号的flatten降阶操作</div><div class="line">RACSignal *flatten = [signal flattenMap:^RACStream *(RACSignal *value) &#123;</div><div class="line">    return value;</div><div class="line">&#125;];</div><div class="line">RACSignal *map = [signal flattenMap:^RACStream *(id value) &#123;</div><div class="line">    id anotherValue = value; // map here!</div><div class="line">    return [RACSignal return: anotherValue];</div><div class="line">&#125;];</div><div class="line">RACSignal *filter = [signal flattenMap:^RACStream *(id value) &#123;</div><div class="line">    BOOL filter = (value == nil); // filter here!</div><div class="line">    return filter ? [RACSignal empty] : [RACSignal return:value];</div><div class="line">&#125;];</div><div class="line">//FlattenMap网络请求数据的逻辑Demo</div><div class="line">RACSignal *signal = [RACSignal return:@&quot;http://xx.com/a&quot;];</div><div class="line">RACSignal *getSignal = [signal flattenMap: ^RACStream *(NSString *url) &#123;</div><div class="line">    NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:url]];</div><div class="line">    return [NSURLConnection rac_sendAsynchronousRequest:request];</div><div class="line">&#125;];</div><div class="line">RACSignal *jsonSignal = [getSignal flattenMap: ^RACStream *(NSData *data) &#123;</div><div class="line">    NSError *error = nil;</div><div class="line">    id result = [NSJSONSerialization JSONObjectWithData:data options:0 error:&amp;error];</div><div class="line">    return error == nil ? [RACSignal return: result] : [RACSignal error: error];</div><div class="line">&#125;];</div><div class="line">RACSignal *getItemSignal = [jsonSignal flattenMap: ^RACStream *(NSDictionary *value) &#123;</div><div class="line">    if (![value isKindOfClass:[NSDictionary class]] || value[@&quot;data.url&quot;] == nil) &#123;</div><div class="line">        return [RACSignal error:someError];</div><div class="line">    &#125;</div><div class="line">    NSURLRequest *anotherRequest = [NSURLRequest requestWithURL:[NSURL URLWithString:value[@&quot;data.url&quot;]]];</div><div class="line">    return [NSURLConnection rac_sendAsynchronousRequest:anotherRequest];</div><div class="line">&#125;];</div><div class="line"></div><div class="line"></div><div class="line">FlattenMap与monad、bind</div><div class="line">Functor</div><div class="line"></div><div class="line">- (instancetype)flattenMap:(RACStream * (^)(id value))block;</div><div class="line">- (instancetype)bind:(RACStreamBindBlock (^)(void))block;</div><div class="line">typedef RACStream * (^RACStreamBindBlock)(id value, BOOL *stop);</div><div class="line">• •</div><div class="line">• •</div><div class="line"></div><div class="line">//bind妙用</div><div class="line">- (RACSignal *)take:(NSUInteger)count &#123;</div><div class="line">    if (count == 0) return [RACSignal empty];</div><div class="line">    return [self bind:^&#123;</div><div class="line">        __block NSUInteger taken = 0;</div><div class="line">        return ^ id (id value, BOOL *stop) &#123;</div><div class="line">            if (taken &lt; count) &#123;</div><div class="line">                ++taken;</div><div class="line">                if (taken == count) *stop = YES;</div><div class="line">                return [class return:value];</div><div class="line">            &#125; else &#123;</div><div class="line">                return nil;</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">    &#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">//bind简单实现和问题</div><div class="line">- (RACSignal *)bind:(RACStreamBindBlock (^)(void))block;</div><div class="line">&#123;</div><div class="line">    return [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">    RACStreamBindBlock bindBlock = block();</div><div class="line">    [self subscribeNext:^(id x) &#123;</div><div class="line">    BOOL stop = NO;</div><div class="line">    RACSignal *signal = (RACSignal *)bindBlock(x, &amp;stop);</div><div class="line">    if (signal == nil || stop) &#123; [subscriber sendCompleted];</div><div class="line">    &#125; else &#123;</div><div class="line">    [signal subscribeNext:^(id x) &#123; [subscriber sendNext:x];</div><div class="line">    &#125; error:^(NSError *error) &#123; [subscriber sendError:error];</div><div class="line">    &#125; completed:^&#123; &#125;];</div><div class="line">    &#125;</div><div class="line">    &#125; error:^(NSError *error) &#123; [subscriber sendError:error];</div><div class="line">    &#125; completed:^&#123; [subscriber sendCompleted]; &#125;];</div><div class="line">    return nil;</div><div class="line">    &#125;];</div><div class="line">&#125;</div><div class="line">//有用的高阶操作</div><div class="line">- (RACSignal *)try:(BOOL (^)(id value, NSError **errorPtr))tryBlock;</div><div class="line">- (RACSignal *)tryMap:(id (^)(id value, NSError **errorPtr))mapBlock;</div><div class="line">- (RACSignal *)catch:(RACSignal * (^)(NSError *error))catchBlock;</div><div class="line">- (RACSignal *)catchTo:(RACSignal *)signal;</div><div class="line">- (RACSignal *)timeout:(NSTimeInterval)interval onScheduler:(RACScheduler *)scheduler;</div><div class="line"></div><div class="line"></div><div class="line">ReactiveCocoa之生命周期详解</div><div class="line">//RACSignal:冷信号的实例状态</div><div class="line">RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">   [subscriber sendNext:@1];</div><div class="line">   [subscriber sendNext:@2];</div><div class="line">   [subscriber sendCompleted];</div><div class="line">   return nil;</div><div class="line">&#125;];</div><div class="line">[signal subscribeNext:^(id x) &#123;</div><div class="line">    NSLog(@&quot;next: %@&quot;, x);</div><div class="line">&#125; error:^(NSError *error) &#123;</div><div class="line">    NSLog(@&quot;error: %@&quot;, error);</div><div class="line">&#125; completed:^&#123;</div><div class="line">    NSLog(@&quot;complete&quot;);</div><div class="line">&#125;];</div><div class="line"></div><div class="line">//RACSubject:热信号的实例状态</div><div class="line">RACSubject *subject = [RACSubject subject];</div><div class="line">[subject subscribeNext:^(id x) &#123;</div><div class="line">    NSLog(@&quot;Subscriber 1 receive next: %@&quot;, x);</div><div class="line">&#125; error:^(NSError *error) &#123;</div><div class="line">    NSLog(@&quot;Subscriber 1 receive error: %@&quot;, error);</div><div class="line">&#125; completed:^&#123;</div><div class="line">    NSLog(@&quot;Subscriber 1 receive complete&quot;);</div><div class="line">&#125;];</div><div class="line">[subject sendNext:@1];</div><div class="line">[subject sendNext:@2];</div><div class="line">[subject sendCompleted];</div><div class="line"></div><div class="line">延时操作和Block生命周期</div><div class="line">NSString *someStr = @&quot;someStr&quot;; </div><div class="line">[[RACScheduler scheduler] afterDelay:1 schedule:^&#123;</div><div class="line">    NSLog(@&quot;%@&quot;, someStr);</div><div class="line">&#125;];</div><div class="line"></div><div class="line">//mainThreadScheduler:延时操作和Block生命周期</div><div class="line">NSString *someStr = @&quot;someStr&quot;;</div><div class="line">[[RACScheduler mainThreadScheduler] afterDelay:1 schedule:^&#123;</div><div class="line">    NSLog(@&quot;%@&quot;, someStr);</div><div class="line">&#125;];</div><div class="line"></div><div class="line">延时操作和Block生命周期</div><div class="line">NSString *someStr = @&quot;someStr&quot;;</div><div class="line">NSString *someOtherStr = @&quot;someOtherStr&quot;;</div><div class="line">[RACScheduler.mainThreadScheduler afterDelay:1 schedule:^&#123;</div><div class="line">    NSLog(@&quot;%@&quot;, someStr);</div><div class="line">    NSString *innerStr = @&quot;innerStr&quot;;</div><div class="line">    [RACScheduler.mainThreadScheduler afterDelay:1 schedule:^&#123;</div><div class="line">        NSLog(@&quot;%@ &amp;&amp; %@&quot;, someOtherStr, innerStr);</div><div class="line">    &#125;];</div><div class="line">&#125;];</div><div class="line"></div><div class="line">//afterDelay:延时订阅冷信号的情况</div><div class="line">RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">    [subscriber sendNext:@1];</div><div class="line">    [subscriber sendNext:@2];</div><div class="line">    [subscriber sendCompleted];</div><div class="line">    return nil;</div><div class="line">&#125;];</div><div class="line">[signal subscribeNext:^(id x) &#123;</div><div class="line">    NSLog(@&quot;Subscriber 1 receive next: %@&quot;, x);</div><div class="line">&#125; error:^(NSError *error) &#123;</div><div class="line">    NSLog(@&quot;Subscriber 1 receive error: %@&quot;, error);</div><div class="line">&#125; completed:^&#123;</div><div class="line">    NSLog(@&quot;Subscriber 1 receive complete&quot;);</div><div class="line">&#125;];</div><div class="line"></div><div class="line">[RACScheduler.mainThreadScheduler afterDelay:1 schedule:^&#123;</div><div class="line">    [signal subscribeNext:^(id x) &#123;</div><div class="line">        NSLog(@&quot;Subscriber 2 receive next: %@&quot;, x);</div><div class="line">    &#125; error:^(NSError *error) &#123;</div><div class="line">        NSLog(@&quot;Subscriber 2 receive error: %@&quot;, error);</div><div class="line">    &#125; completed:^&#123;</div><div class="line">        NSLog(@&quot;Subscriber 2 receive complete&quot;);</div><div class="line">    &#125;];</div><div class="line">&#125;];</div><div class="line"></div><div class="line">//afterDelay:延时订阅热信号的情况</div><div class="line">RACSubject *subject = [RACReplaySubject subject];</div><div class="line">[subject subscribeNext:^(id x) &#123;</div><div class="line">    NSLog(@&quot;Subscriber 1 receive next: %@&quot;, x);</div><div class="line">&#125; error:^(NSError *error) &#123;</div><div class="line">    NSLog(@&quot;Subscriber 1 receive error: %@&quot;, error);</div><div class="line">&#125; completed:^&#123;</div><div class="line">    NSLog(@&quot;Subscriber 1 receive complete&quot;);</div><div class="line">&#125;];</div><div class="line"></div><div class="line">[RACScheduler.mainThreadScheduler afterDelay:1 schedule:^&#123;</div><div class="line">    [subject subscribeNext:^(id x) &#123;</div><div class="line">        NSLog(@&quot;Subscriber 2 receive next: %@&quot;, x);</div><div class="line">    &#125; error:^(NSError *error) &#123;</div><div class="line">        NSLog(@&quot;Subscriber 2 receive error: %@&quot;, error);</div><div class="line">    &#125; completed:^&#123;</div><div class="line">        NSLog(@&quot;Subscriber 2 receive complete&quot;);</div><div class="line">    &#125;];</div><div class="line">&#125;];</div><div class="line">[subject sendNext:@1];</div><div class="line">[subject sendNext:@2];</div><div class="line">[subject sendCompleted];</div><div class="line"></div><div class="line"></div><div class="line">//afterDelay:冷信号延时发送</div><div class="line">RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">    [RACScheduler.mainThreadScheduler afterDelay:1 schedule:^&#123;</div><div class="line">        [subscriber sendNext:@1];</div><div class="line">        [subscriber sendNext:@2];</div><div class="line">    &#125;];</div><div class="line">    [RACScheduler.mainThreadScheduler afterDelay:2 schedule:^&#123;</div><div class="line">        [subscriber sendCompleted];</div><div class="line">    &#125;];</div><div class="line">    return nil;</div><div class="line">&#125;]; </div><div class="line">[signal subscribeNext:^(id x) &#123;</div><div class="line">    NSLog(@&quot;Subscriber 1 receive next: %@&quot;, x);</div><div class="line">&#125; error:^(NSError *error) &#123;</div><div class="line">    NSLog(@&quot;Subscriber 1 receive error: %@&quot;, error);</div><div class="line">&#125; completed:^&#123;</div><div class="line">    NSLog(@&quot;Subscriber 1 receive complete&quot;);</div><div class="line">&#125;];</div><div class="line"></div><div class="line">//afterDelay:热信号延时发送</div><div class="line">RACSubject *subject = [RACSubject subject];</div><div class="line">[subject subscribeNext:^(id x) &#123;</div><div class="line">    NSLog(@&quot;Subscriber 1 receive next: %@&quot;, x);</div><div class="line">&#125; error:^(NSError *error) &#123;</div><div class="line">    NSLog(@&quot;Subscriber 1 receive error: %@&quot;, error);</div><div class="line">&#125; completed:^&#123;</div><div class="line">    NSLog(@&quot;Subscriber 1 receive complete&quot;);</div><div class="line">&#125;];</div><div class="line">[RACScheduler.mainThreadScheduler afterDelay:1 schedule:^&#123;</div><div class="line">    [subject sendNext:@1];</div><div class="line">    [subject sendNext:@2];</div><div class="line">    [subject sendCompleted];</div><div class="line">&#125;];</div><div class="line"></div><div class="line">//信号变换的生命周期</div><div class="line">- (RACSignal *)myMap_:(id (^)(id))map</div><div class="line">&#123;</div><div class="line">    NSCParameterAssert(map != nil);</div><div class="line">    return [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">        [self subscribeNext:^(id x) &#123;</div><div class="line">            [subscriber sendNext:map(x)];</div><div class="line">        &#125; error:^(NSError *error) &#123;</div><div class="line">            [subscriber sendError:error];</div><div class="line">        &#125; completed:^&#123;</div><div class="line">            [subscriber sendCompleted];</div><div class="line">        &#125;];</div><div class="line">        return nil;</div><div class="line">    &#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (RACSignal *)myMap2_:(id (^)(id))map</div><div class="line">&#123;</div><div class="line">    @weakify(self)</div><div class="line">    NSCParameterAssert(map != nil);</div><div class="line">    return [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">        @strongify(self)</div><div class="line">        [self subscribeNext:^(id x) &#123;</div><div class="line">            [subscriber sendNext:map(x)];</div><div class="line">        &#125; error:^(NSError *error) &#123;</div><div class="line">            [subscriber sendError:error];</div><div class="line">        &#125; completed:^&#123;</div><div class="line">            [subscriber sendCompleted];</div><div class="line">        &#125;];</div><div class="line">        return nil;</div><div class="line">    &#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (RACSignal *)myMap_:(id (^)(id))map</div><div class="line">&#123;</div><div class="line">    [self subscribeNext:^(id x) &#123; </div><div class="line">    NSCParameterAssert(map != nil);</div><div class="line">    return [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">        [subscriber sendNext:map(x)];</div><div class="line">    &#125; error:^(NSError *error) &#123;</div><div class="line">        [subscriber sendError:error];</div><div class="line">    &#125; completed:^&#123;</div><div class="line">        [subscriber sendCompleted];</div><div class="line">    &#125;];</div><div class="line">        return nil;</div><div class="line">  &#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line">void signalTransform()</div><div class="line">&#123;</div><div class="line">    RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; s) &#123;</div><div class="line">        [s sendNext:@1];</div><div class="line">        [RACScheduler.mainThreadScheduler afterDelay:1 schedule:^&#123;</div><div class="line">            [s sendCompleted];</div><div class="line">        &#125;];</div><div class="line">        return nil;</div><div class="line">    &#125;];</div><div class="line">    RACSignal *signal2 = [signal myMap_:^id(NSNumber *value) &#123;</div><div class="line">        return @(value.integerValue * 2);</div><div class="line">    &#125;];</div><div class="line"></div><div class="line">    [RACScheduler.mainThreadScheduler afterDelay:1 schedule:^&#123;</div><div class="line">        [signal2 subscribeNext:^(id x) &#123;</div><div class="line">            NSLog(@&quot;Subscriber 1 receive next: %@&quot;, x);</div><div class="line">        &#125; error:^(NSError *error) &#123;</div><div class="line">            NSLog(@&quot;Subscriber 1 receive error: %@&quot;, error);</div><div class="line">        &#125; completed:^&#123;</div><div class="line">            NSLog(@&quot;Subscriber 1 receive complete&quot;);</div><div class="line">        &#125;];</div><div class="line">    &#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line">//信号组合时的生命周期</div><div class="line">+ (RACSignal *)myMerge_:(id&lt;NSFastEnumeration&gt;)signals</div><div class="line">&#123;</div><div class="line">    return [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">        for (RACSignal *signal in signals) &#123;</div><div class="line">            [signal subscribeNext:^(id x) &#123;</div><div class="line">                [subscriber sendNext:x];</div><div class="line">            &#125; error:^(NSError *error) &#123;</div><div class="line">                [subscriber sendError:error];</div><div class="line">            &#125; completed:^&#123;</div><div class="line">                [subscriber sendCompleted];</div><div class="line">            &#125;];</div><div class="line">        &#125;</div><div class="line">        return nil;</div><div class="line">    &#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">//RACDisposable对象断开订阅连接和RACScheduler对象（销毁信号）</div><div class="line">@interface RACDisposable : NSObject</div><div class="line">@property (atomic, assign, getter = isDisposed, readonly) BOOL disposed;</div><div class="line">+ (instancetype)disposableWithBlock:(void (^)(void))block;</div><div class="line">- (void)dispose;</div><div class="line">@end</div><div class="line"></div><div class="line">//RACDisposable:生命周期</div><div class="line">RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">    [subscriber sendNext:@1];</div><div class="line">    [RACScheduler.mainThreadScheduler afterDelay:2 schedule:^&#123;</div><div class="line">        [subscriber sendNext:@2];</div><div class="line">        [subscriber sendCompleted];</div><div class="line">    &#125;];</div><div class="line">    return [RACDisposable disposableWithBlock:^&#123;</div><div class="line">        NSLog(@&quot;dispose!!!&quot;);</div><div class="line">    &#125;];</div><div class="line">&#125;];</div><div class="line"></div><div class="line">RACDisposable *disposable = [signal subscribeNext:^(id x) &#123;</div><div class="line">    NSLog(@&quot;next: %@&quot;, x);</div><div class="line">&#125; completed:^&#123;</div><div class="line">    NSLog(@&quot;complete&quot;);</div><div class="line">&#125;];</div><div class="line"></div><div class="line">[RACScheduler.mainThreadScheduler afterDelay:1 schedule:^&#123;</div><div class="line">    [disposable dispose];</div><div class="line">&#125;];</div><div class="line"></div><div class="line">//RACDisposable:block的作用</div><div class="line">RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">    [subscriber sendNext:@1];</div><div class="line">    RACDisposable *disposable1 = [RACScheduler.mainThreadScheduler afterDelay:2 schedule:^&#123;</div><div class="line">        [subscriber sendNext:@2];</div><div class="line">    &#125;];</div><div class="line">    RACDisposable *disposable2 = [RACScheduler.mainThreadScheduler afterDelay:2 schedule:^&#123;</div><div class="line">        [subscriber sendCompleted];</div><div class="line">    &#125;];</div><div class="line">    return [RACDisposable disposableWithBlock:^&#123;</div><div class="line">        [disposable1 dispose];</div><div class="line">        [disposable2 dispose];</div><div class="line">        NSLog(@&quot;dispose!!!&quot;);</div><div class="line">    &#125;];</div><div class="line">&#125;];</div><div class="line"></div><div class="line">RACDisposable *disposable = [signal subscribeNext:^(id x) &#123;</div><div class="line">    NSLog(@&quot;next: %@&quot;, x);</div><div class="line">&#125; completed:^&#123;</div><div class="line">    NSLog(@&quot;complete&quot;);</div><div class="line">&#125;];</div><div class="line"></div><div class="line">[RACScheduler.mainThreadScheduler afterDelay:1 schedule:^&#123;</div><div class="line">    [disposable dispose];</div><div class="line">&#125;];</div><div class="line"></div><div class="line">//RACDisposable家族成员一:RACScopedDisposable绑定对象生存期的disposable</div><div class="line"></div><div class="line">+ (instancetype)scopedDisposableWithDisposable:(RACDisposable *)disposable;</div><div class="line">- (RACScopedDisposable *)asScopedDisposable;</div><div class="line"></div><div class="line">RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">    [subscriber sendNext:@1];</div><div class="line">    RACDisposable *disposable1 = [RACScheduler.mainThreadScheduler afterDelay:2 schedule:^&#123;</div><div class="line">        [subscriber sendNext:@2];</div><div class="line">    &#125;];</div><div class="line">    RACDisposable *disposable2 = [RACScheduler.mainThreadScheduler afterDelay:2 schedule:^&#123;</div><div class="line">        [subscriber sendCompleted];</div><div class="line">    &#125;];</div><div class="line">    return [RACDisposable disposableWithBlock:^&#123;</div><div class="line">        [disposable1 dispose];</div><div class="line">        [disposable2 dispose];</div><div class="line">        NSLog(@&quot;dispose!!!&quot;);</div><div class="line">    &#125;];</div><div class="line">&#125;];</div><div class="line">RACDisposable *disposable = [signal subscribeNext:^(id x) &#123;</div><div class="line">    NSLog(@&quot;next: %@&quot;, x);</div><div class="line">&#125; completed:^&#123;</div><div class="line">    NSLog(@&quot;complete&quot;);</div><div class="line">&#125;];</div><div class="line">self.someProp = disposable.asScopedDisposable;</div><div class="line"></div><div class="line">//RACDisposable家族成员一:RACSerialDisposable可替换的disposable包裹</div><div class="line"></div><div class="line">+ (instancetype)serialDisposableWithDisposable:(RACDisposable *)disposable;</div><div class="line">@property (atomic, strong) RACDisposable *disposable;</div><div class="line"></div><div class="line">- (RACSignal *)myConcat:(RACSignal *)signal</div><div class="line">&#123;</div><div class="line">    return [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">    RACSerialDisposable *mainDisposable = [[RACSerialDisposable alloc] init];</div><div class="line">    mainDisposable.disposable = [self subscribeNext:^(id x) &#123;</div><div class="line">            [subscriber sendNext:x];</div><div class="line">        &#125; error:^(NSError *error) &#123;</div><div class="line">            [subscriber sendError:error];</div><div class="line">        &#125; completed:^&#123;</div><div class="line">            mainDisposable.disposable = [signal subscribe:subscriber];</div><div class="line">        &#125;];</div><div class="line">        return mainDisposable;</div><div class="line">    &#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line">家族成员一:RACSerialDisposable多个disposable的包裹</div><div class="line"></div><div class="line">- (void)addDisposable:(RACDisposable *)disposable;</div><div class="line">- (void)removeDisposable:(RACDisposable *)disposable;</div><div class="line"></div><div class="line">+ (RACSignal *)myMerge:(id&lt;NSFastEnumeration&gt;)signals</div><div class="line">&#123;</div><div class="line">    return [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">        RACCompoundDisposable *mainDisposable = [[RACCompoundDisposable alloc] init];</div><div class="line">        for (RACSignal *signal in signals) &#123;</div><div class="line">            [mainDisposable addDisposable:[signal subscribeNext:^(id x) &#123;</div><div class="line">                [subscriber sendNext:x];</div><div class="line">            &#125; error:^(NSError *error) &#123;</div><div class="line">                [subscriber sendError:error];</div><div class="line">                [mainDisposable dispose];</div><div class="line">            &#125; completed:^&#123;</div><div class="line">                [subscriber sendCompleted];</div><div class="line">                [mainDisposable dispose];</div><div class="line">            &#125;]];</div><div class="line">        &#125;</div><div class="line">        return mainDisposable;</div><div class="line">    &#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line">ReactiveCocoa之实战演练</div><div class="line">FRP概论！简单变换、组合高阶函数！冷热信号！并发编程！生命周期与订阅销毁！RACChannel！</div><div class="line">RACCommand作用？</div><div class="line">重复执行一个过程！开关控制！防重入！错误异常的处理！结果统一处理！</div><div class="line">RACChannel作用?</div><div class="line">双向通道！类似通话！处理回声问题！</div><div class="line">RAC的循环引用问题？</div><div class="line">RAC中如何识别判断循环引用！如何解决循环引用！破除循环引用的一端！避免构造循环引用</div><div class="line">常见情况分析？</div><div class="line">strong指针可能会引起循环引！weak指针不会引起循环引！block持有self != 循环引！block对捕获的strong指针会进行引用！block对捕获的weak指针不会进行引用</div><div class="line">Weakify &amp; Strongify的使用说明？1、必须成对使用否则无效2、不只是用于self，也可用于其他变量3、必须在使用前@strongify，否则无效4、可以同时处理多个对象@weakify(a, b, c)</div><div class="line">循环引用的多种情况解析？1、信号创建时引起的循环引2、信号订阅时引起的循环引3、block嵌套时加几个strongify</div><div class="line">RAC宏的使用？</div><div class="line">RAC(self, a.b) vs RAC(self.a, b)的区别？1、被绑定的对象2、间接属性变化3、建议使用RAC(self, a.b)</div><div class="line">取消RAC的宏绑定？1、重复绑定会抛异常2、takeUntil取消绑定3、使用展开式,调用方法</div><div class="line">RACObserve(self, a.b) vs RACObserve(self.a, b)1、被监听的对象2、间接属性变化3、建议使用RACObserve(self, a.b)</div><div class="line">适合RAC的情景？1、异步场景，异步处理需求、处理成功subscribeNext、处理异常和错误subscribeError 2、事件处理。UI事件、Delegate 3、切面处理。KVO</div><div class="line">什么样的功能适合RAC！让OOP与FRP配合使！从FRP的叫度来分析问题！RAC使用小技巧</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/09/线程管理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Carden007">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://static.pexels.com/photos/33392/portrait-bird-nature-wild.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Carden's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/09/线程管理/" itemprop="url">线程管理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-09T12:16:21+08:00">
                2017-06-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>#术语</p>
</blockquote>
<p><strong>任务</strong>：准备执行的操作，通常就是一个block块</p>
<p><strong>队列</strong>：queue，存放任务，管理任务</p>
<p><strong>进程</strong>——苹果电脑里的活动监视器App里详细罗列了操作系统此时此刻正在运行的所有程序，同时标明了每一个进行的程序的所有线程。</p>
<p><strong>线程</strong>——将一个程序都转换成汇编的CPU命令时，由一堆不分叉的Cpu指令组成的路径（主线程命令和分线程命令）</p>
<p><strong>多线程编程</strong>——由多条不分叉的CPU指令所组成的路径就是多线程编程。优点：提高资源利用率和程序执行效率，用户体验    缺点：1、上下文切换频率太高会影响性能 2、资源竞争—&gt;上锁（类似单例）3、死锁  4、开辟的线程其实类似于创建一个对象，会消耗大量内存（内核数据结构（大约1KB）、栈空间（子线程512KB、主线程1MB，也可以使用-setStackSize:设置，但必须是4K的倍数，而且最小是16K），创建线程大约需要90毫秒的创建时间）5、程序设计更加复杂：比如线程之间的通信、多线程的数据共享</p>
<p><strong>CPU包括</strong>——1、物理CPU（硬件）2、CPU核 （一个物理CPU可以虚拟出多个CPU核，一个CPU核就相当于一个CPU的功能，可以分身，一个CPU核一个时刻只能执行一个CPU命令）</p>
<p><strong>并发</strong>——虽然同一时间，CPU只能处理1条线程，只有1条线程在执行，但是CPU可以快速地在多条线程之间调度切换，如果CPU调度线程的时间足够快，就造成了多线程并发执行的假象。当然如果线程过多，会消耗大量的CPU资源，同时每条线程被调度执行的频次会降低（线程的执行效率降低）</p>
<blockquote>
<p>#多核就快</p>
</blockquote>
<p>首先谈一谈就是程序执行的本质，我们写的代码都首先是转化成一行行的汇编代码才能被计算机所识别。这一行行的汇编代码其实也叫做CPU指令。这里面就涉及到CPU了，CPU就是读取这些指令的工具。当然，有一种汇编代码也就是CPU指令的结构是从头到尾不间断的，也就是这些CPU指令一点也没有分叉，从头到尾都是直路，就像高速公路一样，只有直路，没有岔路。可是程序的魅力就在于，遇到分岔路时或更复杂的十字路口时应该怎么办？肯定不能一根筋呀！于是CPU厂商就想到了一个方法，就是分身术，当遇到分叉路的时候就像孙悟空一样，复制一个自己来走新出现的分岔路。可是问题来了，如果第二次又遇到分叉路怎么办呢？两种思路，第一种再复制一个自己。第二种就是用那个复制的自己轮流前进。第一种方法主要受到CPU本身性能的局限。有的CPU只能复制一个自己，算上本身总共才两个。也有的CPU可以复制三个自己，算上本身总共有4个。这种具体去跑马路的车就叫做CPU核，所以你会发现，CPU越强大，也就是能够复制的自己越多，能够同时走的分叉路就越多，自然而然，四核就是比双核快。第二种方法就是让CPU的寄存器不断受到考验，当CPU分配那个复制的自己在那一条道路上奔跑时，必须时时记录下来这个复制的自己已经在每一条分叉路上已经跑了多远，并需要准确无误的保存在寄存器中，然后当CPU再一次将那个复制的自己放在相应地分岔路上继续跑时，就会读取寄存器里面的数据来继续前进。</p>
<blockquote>
<p>#主线程刷UI</p>
</blockquote>
<p>因为分线程不能刷新UI，但是有的时候明明看见刷新UI的代码写在了分线程里，但这并不代表这些代码会被分线程（复制的CPU核）执行，分线程主要是负责数据的下载。（两种情况：1、下载完成后主动回到主线程，告诉主线程自己已经完成下载，可以让主线程执行分线程没有资格执行的代码 2、需要主线程不定期去主动检查也就是说,尽管你把刷新UI的代码写在了分线程，但分线程只会执行其中的下载代码，根本不会执行刷新UI的代码。刷新UI的代码会等到主线程不定期的主动检查分线程时才会被执行。所以这样会出现一些延时，所以应该在下载完成后主动回到主线程）</p>
<blockquote>
<p>#时间片</p>
</blockquote>
<p>如果同一个CPU核去管理多个线程时，就会涉及到时间分配的问题，如果管理的是两个线程，线程一有10个命令，线程二有20个命令，CPU核会将时间片分配给两个线程，一一去执行完两个线程里面的所有命令，当一个线程切换到另一个线程时，系统会将当前线程的信息保存到寄存器中，等下次切换过来到时候唤醒寄存器，读取数据，从上一次的命令接着处理。这就是上下文切换。上下文切换——时间片分配（随机分配CPU核给那一个分线程，同时保存每一分线程上一次执行到的位置到寄存器中，告诉CPU核现在该从第几个CPU指令开始执行）</p>
<p><img src="http://upload-images.jianshu.io/upload_images/645301-c79b90a8b2e8224e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iOS多线程"></p>
<blockquote>
<p>#NSThread</p>
</blockquote>
<ul>
<li>创建、启动线程</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">NSThread *thread = [[NSThread alloc] initWithTarget:self selector:@selector(run) object:nil];</div><div class="line">[thread start];</div></pre></td></tr></table></figure>
<ul>
<li>线程相关用法</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">// 获得当前线程</div><div class="line">NSThread *current = [NSThread currentThread];</div><div class="line"></div><div class="line">// 线程名字</div><div class="line">- (void)setName:(NSString *)name;</div><div class="line">- (NSString *)name;</div><div class="line"></div><div class="line">// 获得主线程</div><div class="line">+ (NSThread *)mainThread; </div><div class="line"></div><div class="line">// 判断是否主线程</div><div class="line">- (BOOL)isMainThread; </div><div class="line">+ (BOOL)isMainThread;</div><div class="line"></div><div class="line">// 创建线程后自动启动</div><div class="line">[NSThread detachNewThreadSelector:@selector(run) toTarget:self withObject:nil];</div><div class="line"></div><div class="line">// 隐式创建并启动线程</div><div class="line">[self performSelectorInBackground:@selector(run)  withObject:nil];</div><div class="line"></div><div class="line">// 阻塞（暂停）线程</div><div class="line">+ (void)sleepUntilDate:(NSDate *)date;</div><div class="line">+ (void)sleepForTimeInterval:(NSTimeInterval)ti;</div><div class="line"></div><div class="line">// 强制停止线程</div><div class="line">+ (void)exit;</div></pre></td></tr></table></figure>
<blockquote>
<p>#GCD全称Grand Central Dispatch</p>
</blockquote>
<p>纯C语言函数，为多核并行运算而生，自动利用更多的CPU内核（比如双核、四核），且自动管理线程的生命周期（创建线程、调度任务、销毁线程），只需告诉GCD想要执行的任务，根本无需写任何管理线程生命周期的代码。队列管理任务执行顺序，同步异步决定任务执行线程。</p>
<ul>
<li>GCD创建并发队列</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">// 创建并发队列（队列名称，队列类型）</div><div class="line">dispatch_queue_t   myQueue = dispatch_queue_create(const char *label,   dispatch_queue_attr_t attr);</div><div class="line"></div><div class="line">// 获得默认并发队列（队列优先级，缺省参数0）</div><div class="line">dispatch_queue_t  systemQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0); </div><div class="line"></div><div class="line">// 任务加入并发队列</div><div class="line">dispatch_async(queue, ^&#123;</div><div class="line">        NSLog(@&quot;1-----%@&quot;, [NSThread currentThread]);</div><div class="line">&#125;);</div><div class="line">dispatch_async(queue, ^&#123;</div><div class="line">        NSLog(@&quot;2-----%@&quot;, [NSThread currentThread]);</div><div class="line">&#125;);</div><div class="line">dispatch_async(queue, ^&#123;</div><div class="line">        NSLog(@&quot;3-----%@&quot;, [NSThread currentThread]);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<ul>
<li>GCD创建串行队列</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">// 创建串行队列（队列名称，队列类型）</div><div class="line">dispatch_queue_t  myQueue = dispatch_queue_create(&quot;串行队列&quot;, DISPATCH_QUEUE_SERIAL)；</div><div class="line"></div><div class="line">// 直接获取主队列 = 特殊串行队列</div><div class="line">dispatch_queue_t  systemQueue = dispatch_get_main_queue();</div><div class="line"></div><div class="line">// 任务加入串行队列</div><div class="line">dispatch_sync(queue, ^&#123;</div><div class="line">        NSLog(@&quot;1-----%@&quot;, [NSThread currentThread]);</div><div class="line">&#125;);</div><div class="line">dispatch_async(queue, ^&#123;</div><div class="line">        NSLog(@&quot;2-----%@&quot;, [NSThread currentThread]);</div><div class="line">&#125;);</div><div class="line">dispatch_async(queue, ^&#123;</div><div class="line">        NSLog(@&quot;3-----%@&quot;, [NSThread currentThread]);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<ul>
<li>GCD同步执行任务</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// 继续当前线程（队列，任务）</div><div class="line">dispatch_sync(dispatch_queue_t queue, dispatch_block_t block);</div></pre></td></tr></table></figure>
<ul>
<li>GCD异步执行任务</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// 开启新线程（队列，任务）</div><div class="line">dispatch_async(dispatch_queue_t queue, dispatch_block_t block);</div></pre></td></tr></table></figure>
<ul>
<li>GCD线程通信</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">// 从子线程回到主线程</div><div class="line">dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">                // 执行耗时的异步操作...</div><div class="line"></div><div class="line"></div><div class="line">        dispatch_async(dispatch_get_main_queue(), ^&#123;</div><div class="line">               // 回到主线程，执行UI刷新操作</div><div class="line"></div><div class="line">         &#125;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">// 对比performSelector的线程通信</div><div class="line">- (void)performSelectorOnMainThread:(SEL)aSelector withObject:(id)arg waitUntilDone:(BOOL)wait;</div><div class="line">- (void)performSelector:(SEL)aSelector onThread:(NSThread *)thr withObject:(id)arg waitUntilDone:(BOOL)wait;</div></pre></td></tr></table></figure>
<ul>
<li>GCD延时执行</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">// GCD延时</div><div class="line">dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(2.0 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</div><div class="line">    // 2秒后异步执行这里的代码...</div><div class="line">&#125;);</div><div class="line"></div><div class="line">// 对比performSelector延时</div><div class="line">[self performSelector:@selector(run) withObject:nil afterDelay:2.0];</div><div class="line"></div><div class="line">// 对比NSTimer延时</div><div class="line">[NSTimer scheduledTimerWithTimeInterval:2.0 target:self selector:@selector(test) userInfo:nil repeats:NO];</div></pre></td></tr></table></figure>
<ul>
<li>GCD单例执行</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// 保证某段代码在程序运行过程中只被执行1次</div><div class="line">static dispatch_once_t onceToken;</div><div class="line">dispatch_once(&amp;onceToken, ^&#123;</div><div class="line">    // 只执行1次的代码(这里面默认是线程安全的)</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<ul>
<li>GCD创建定时器执行代码块</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">// 创建Timer</div><div class="line">self.timer = dispatch_source_create(DISPATCH_SOURCE_TYPE_TIMER, 0, 0, dispatch_get_main_queue());</div><div class="line">// 设置定时器的触发时间（1秒后）和时间间隔（每隔2秒）</div><div class="line">dispatch_source_set_timer(self.timer, dispatch_time(DISPATCH_TIME_NOW, 1.0 * NSEC_PER_SEC), 2 * NSEC_PER_SEC, 0);</div><div class="line">// 设置Block回调</div><div class="line">dispatch_source_set_event_handler(self.timer, ^&#123;</div><div class="line">     NSLog(@&quot;Timer %@&quot;, [NSThread currentThread]);</div><div class="line">&#125;);</div><div class="line">// 开启定时器</div><div class="line">dispatch_resume(self.timer);</div><div class="line"></div><div class="line"></div><div class="line">// 取消置空定时器</div><div class="line">dispatch_cancel(self.timer);</div><div class="line">self.timer = nil;</div></pre></td></tr></table></figure>
<ul>
<li>GCD实现任务依赖</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">// 队列组管理任务一和任务二</div><div class="line">dispatch_group_t group =  dispatch_group_create();</div><div class="line"></div><div class="line">// 异步执行任务一</div><div class="line">dispatch_group_async(group, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">    </div><div class="line">&#125;);</div><div class="line"></div><div class="line">// 异步执行任务二</div><div class="line">dispatch_group_async(group, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">   </div><div class="line">&#125;);</div><div class="line"></div><div class="line">// 任务一和任务二都结束Block回调</div><div class="line">dispatch_group_notify(group, dispatch_get_main_queue(), ^&#123;</div><div class="line">    </div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<ul>
<li>GCD分线程遍历</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> *   GCD快速异步遍历</div><div class="line"> */</div><div class="line">- (void)apply</div><div class="line">&#123;</div><div class="line">    dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);</div><div class="line">    NSString *from = @&quot;初始路径&quot;;</div><div class="line">    NSString *to = @目标路径&quot;;</div><div class="line">    </div><div class="line">    NSFileManager *mgr = [NSFileManager defaultManager];</div><div class="line">    NSArray *subpaths = [mgr subpathsAtPath:from];</div><div class="line">    </div><div class="line">    dispatch_apply(subpaths.count, queue, ^(size_t index) &#123;</div><div class="line">        NSString *subpath = subpaths[index];</div><div class="line">        NSString *fromFullpath = [from stringByAppendingPathComponent:subpath];</div><div class="line">        NSString *toFullpath = [to stringByAppendingPathComponent:subpath];</div><div class="line">        [mgr moveItemAtPath:fromFullpath toPath:toFullpath error:nil]; // 剪切</div><div class="line">        NSLog(@&quot;%@---%@&quot;, [NSThread currentThread], subpath);</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">/**</div><div class="line"> *  对比传统异步遍历</div><div class="line"> */</div><div class="line">- (void)moveFile &#123;</div><div class="line">    NSString *from = @&quot;初始路径&quot;;</div><div class="line">    NSString *to = @目标路径&quot;;</div><div class="line"></div><div class="line">    NSFileManager *mgr = [NSFileManager defaultManager];</div><div class="line">    NSArray *subpaths = [mgr subpathsAtPath:from];</div><div class="line"></div><div class="line">    for (NSString *subpath in subpaths) &#123;</div><div class="line">        NSString *fromFullpath = [from stringByAppendingPathComponent:subpath];</div><div class="line">        NSString *toFullpath = [to stringByAppendingPathComponent:subpath];</div><div class="line"></div><div class="line">        dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">            [mgr moveItemAtPath:fromFullpath toPath:toFullpath error:nil]; // 剪切</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>#NSOperation&amp;&amp;NSOperationQueue</p>
</blockquote>
<p>NSOperation是个并不具备封装操作能力的抽象类，必须使用它的子类来封装操作，NSOperation子类包括NSInvocationOperation、NSBlockOperation、自定义子类继承NSOperation。如果仅仅是实例化了一个操作对象，然后简简单单的执行这个操作的start方法，这样没有丝毫意义，还不如在.m文件里面写一个私有方法来得直接，可是一旦把实例化的NSOperation对象放到NSOperationQueue队列之中，添加到队列里面的操作对象会自动开始调用操作对象的start方法，开始异步在一条新的线程里面执行封装在操作对象里面的一系列代码，这就实现了分线程操作了，好神奇有木有！</p>
<ul>
<li>创建NSInvocationOperation操作</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">//  创建NSInvocationOperation对象</div><div class="line">- (id)initWithTarget:(id)target selector:(SEL)sel object:(id)arg;</div><div class="line"></div><div class="line">//  默认同步，除非添加操作到队列</div><div class="line">- (void)addOperation:(NSOperation *)op;</div></pre></td></tr></table></figure>
<ul>
<li>创建NSBlockOperation操作</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">//  创建NSBlockOperation</div><div class="line">+ (id)blockOperationWithBlock:(void (^)(void))block;</div><div class="line"></div><div class="line">//  添加更多操作（只要任务数&gt;1，就会异步执行操作）</div><div class="line">- (void)addExecutionBlock:(void (^)(void))block;</div></pre></td></tr></table></figure>
<ul>
<li>创建自定义NSOperation操作</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">重写父类NSOperation的main方法，在main方法里面写入我想要封装的执行的任务，但是有一点需要特别注意，就是自己写的这段代码很可能会是在子线程里面异步执行，既然是异步操作，自然无法访问主线程的自动释放池，对象的内存释放便是需要重点考虑的内容。经常的做法就是，在封装想要执行的代码之前，必须先判断一下这个操作对象是否已经被取消，因为一旦开始执行进入了子线程就无法在判断isCancelled这个属性了，所以必须在开始执行封装的代码之前，必须先判断这个操作对象是否已经被取消。如果判断已经取消，我需要做的就是一些内存的管理。</div></pre></td></tr></table></figure>
<ul>
<li>创建NSOperation操作依赖</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">// 一定先让操作A执行完毕，然后才能执行操作B</div><div class="line">[operationB addDependency:operationA]; </div><div class="line">！！！一定注意不能相互依赖</div></pre></td></tr></table></figure>
<ul>
<li>监听NSOperation操作执行完毕</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">- (void (^)(void))completionBlock;</div><div class="line">- (void)setCompletionBlock:(void (^)(void))block;</div></pre></td></tr></table></figure>
<ul>
<li>添加操作到NSOperationQueue对列</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">- (void)addOperation:(NSOperation *)op;</div><div class="line">- (void)addOperationWithBlock:(void (^)(void))block;</div></pre></td></tr></table></figure>
<ul>
<li>设置操作对列NSOperationQueue最大并发数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">- (NSInteger)maxConcurrentOperationCount;</div><div class="line">- (void)setMaxConcurrentOperationCount:(NSInteger)cnt;</div></pre></td></tr></table></figure>
<ul>
<li>对列NSOperationQueue的取消、暂停、恢复</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">//  取消队列操作</div><div class="line">- (void)cancelAllOperations;</div><div class="line">- (void)cancel；</div><div class="line"></div><div class="line">// 暂停Or恢复队列</div><div class="line">- (void)setSuspended:(BOOL)bool; </div><div class="line">- (BOOL)isSuspended;</div></pre></td></tr></table></figure>
<blockquote>
<p>#GCD和NSOperation的区别？</p>
</blockquote>
<p>GCD无法控制线程的最大并发数，而NSOperation可以控制同时进行的线程个数！</p>
<blockquote>
<p>#开辟多线程？</p>
</blockquote>
<ul>
<li><strong>performSelector</strong></li>
</ul>
<p>作为<code>NSObject</code>的类别，因此只要是控制器的对象就可以直接调用这个方法。而且不仅仅可以通过<code>performSelectorInBackground</code>将耗时操作放进分线程里，更可以通过<code>performSelectorOnMainThread</code>将分线程里的参数传递到主线程以便进一步操作，例如刷新<code>UI</code>。</p>
<ul>
<li><strong>NSThread线程类</strong></li>
</ul>
<p><code>thread</code>本身就是线的意思。通过<code>NSThread</code>类实例化一个对象。然后直接通过初始化方法就可以像为<code>UIButton</code>增添点击事件那样增添一个在分线程里进行的方法。而且可以传递给这个分线程方法一个无论什么对象类型的参数。但是特别注意：通过<code>NSThread</code>类实例化的对象所初始化增添的分线程方法必须通过[对象 start]方法表示开始执行分线程方法。而且无论第三方工具如何丰富，本质上都是对<code>NSThread</code>进行一系列操作。所以说在任何情况下都可以调用<code>[NSThread currentThread]</code>这个类方法获取到当前的线程信息，有点像代码版的活动监视器哈！这是苹果提供的三种方法里面相对轻量级的，但需要管理线程的生命周期、同步、加锁的问题，这会导致一定得性能开销。</p>
<ul>
<li><strong>GCD队列Grand Central Dispatch</strong></li>
</ul>
<p>伟大的中枢调度器，充分发挥CPU内核的性能，自动管理线程的生命周期，包括创建线程，调度任务和销毁线程。而且使用过程中只需添加任务即可，无需管理线程。</p>
<ul>
<li><strong>NSOperation</strong></li>
</ul>
<p>一块资源可能会被多个线程共享，通常添加互斥锁<code>@synchronized(self){}</code>来避免引发数据错乱和数据安全问题。但是添加互斥锁会影响手机的性能，所以尽量将加锁和资源抢夺业务的逻辑交给服务器端处理，线程不会孤立存在，子线程下载图片，在主线程刷新UI显示图片。使用<code>@synchronized(self的锁对象){}</code>包起来的代码同一时刻只能被一个线程执行，而且加锁的时候尽量缩小范围，范围越大就越消耗性能。</p>
<blockquote>
<p>#串行队列Vs并行队列？</p>
</blockquote>
<p><strong>相同点</strong>：</p>
<ul>
<li><p>创建方式都是<code>dispatch_queue_t queue</code>，只不过创建队列时的标志符后面的参数有了一些变化，主要有<code>（NULL， DISPATCH_QUEUE_SERIAL，DISPATCH_QUEUE_CONCURRENT）</code>三种类型。前两种等价都可以表示串行队列。而且有一个细节就是标识符的格式是否有要求一时确定不了！</p>
</li>
<li><p>往队列里添加任务的方式一模一样，都是<code>dispatch_async(queue, ^{})</code>这种格式。凡是创建的队列都是以分线程的形式存在。所以对于一个分线程队列来说就必须考虑如何返回到主线程。而且这也不是说纯粹意义上的将这个分线程注销，更多的是想将无法在分线程中执行的代码及时的传递到主线程以便进行下一步操作。</p>
</li>
<li><p>将分线程中下载完成的数据如何让以参数的形式传递到主线程呢？两种方法，方法1就是使用控制器的对象调用<code>performSelectorOnMainThread</code>方法。方法2就是通过<code>dispatch_queue_t mainQueue = dispatch_get_main_queue()</code>获取到主队列，这也就代表了主线程。通过在主队列中添加任务也就等于是通过主线程来执行分线程无法执行的代码。而且方法2还有一个优点就是，无需像方法一那样过于纠结于到底应该将分线程的什么参数传递出去，因为方法二是直接建立在分线程的基础上，本质上只是起一个临时调用主线程的功能，因此方法二可以直接调用分线程里的任何参数变量。</p>
</li>
<li><p>如果不理解什么是串行队列，其实主队列<code>dispatch_queue_t mainQueue = dispatch_get_main_queue()</code>就是一个典型的串行队列，无论你添加多少任务总是按照任务的添加顺序依次执行，没有例外。而且自始至终都是一个线程，而且这个线程就叫做主线程。</p>
</li>
</ul>
<p><strong>不同点</strong>：</p>
<ul>
<li><p>串行队列无论添加多少个任务都只是创建了一个分线程，而且执行任务的顺序严格按照添加任务的先后顺序进行。而对于并行队列而言，往并行对列中每增添一个任务就创建了一个分线程。也就是说并行队列中有多少个任务就有多少个分线程，我们也都知道，线程其实本质上也是一个对象，是对象就必须开辟内存，因此虽然说创建很多的分线程有利于获得良好的用户体验，但这对于用户终端的内存是一个极大的考验。</p>
</li>
<li><p>并行队列的任务因为是一个任务对应一个分线程。所以可以认为并行队列里的任务是同时进行的。所以最终并行队列里的哪一个任务最先执行结束的关键还在于任务的具体内容。</p>
</li>
<li><p>对于并行队列而言有一种很特殊的需求就是：我想准确地知道并行队列里的最后一个任务是什么时候执行完毕，然后我再进行下一部操作，因为通常情况下是无法准确地获取到现在并行队列的任务到底执行到了一个什么阶段。根本无法像串行队列那样通过添加任务的先后顺序来推断出到底哪一个任务结束后标志着队列任务全部结束！解决方案就是给并行队列添加一个<code>group</code>。同样需要通过<code>dispatch_queue_t  queue = dispatch_queue_create(&quot;123&quot;, DISPATCH_QUEUE_CONCURRENT)</code>先创建一个并行队列，然后通过<code>dispatch_group_t group = dispatch_group_create()</code>创建一个管理并行队列里所有任务的组。接着跟常规添加任务到并行队列不同的是：<code>dispatch_group_async(group, queue, ^{});</code>当然从分线程返回到主线程的方法<code>dispatch_async(dispatch_get_main_queue(), ^{});</code>并没有发生变化。把所有的任务添加到有管理组的并行队列中目的就是时刻监听并行队列里的任务的进行阶段，监听到并行队列里所有的任务全部结束时就会触发方法<code>dispatch_group_notify(group,dispatch_get_main_queue(),^{});</code>需要注意的是，这个方法里面的代码全部是由主线程执行。因为并行队列里的所有任务所对应的分线程也已经结束。监听到任务结束自动将监听方法里面的代码交由主线程执行。这也就是说，其实管理并行队列里所有任务的组<code>group</code>的监听方法其实本质上就是就是并行队列里所有任务都结束后返回到主线程以便进行下一步操作。</p>
</li>
<li><p>如果我们想要创建多个并行对列，那么又如何确定哪一个并行队列率先执行呢，答案是，根据并行队列的优先级来进行判断。创建有优先级的并行队列的方法为dispatch_queue_t queue1 = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0)。当然在这里将并行队列的优先级设置为了默认，也就相当于又增加了一种创建普通并行队列的方法。</p>
</li>
<li><p>如果我想队列里的任务在多少秒之后才开始执行，那么最简单的方法就是在具体的任务里添加睡眠延时<code>sleep(1)</code>，但是的但是这也仅仅适用于串行队列中，而且就算这样可以也会带来一个整体任务进行的延时。对于并行队列来说，只要添加完了任务就会全面开始，根本不会停下来，所以最好的方法就是通过<code>dispatch_time_t  time = dispatch_time(DISPATCH_TIME_NOW, 4ull*NSEC_PER_MSEC)</code>来设置过4秒后再通过<code>dispatch_after(time, queue, ^{})</code>将任务添加到队列<code>queue</code>中。这样就可以完美的实现至少在多少秒后再进行某一个任务。6、无论在串行队列还是在并行队列中，有时候我们想要某个任务只进行一次，就算这是一个死循环的队列，也要保证某个任务只被执行一次，方法就是先用<code>static  dispatch_once_t  onceTaken</code>确定谓词<code>onceTaken</code> ，用来保证<code>dispatch_once(&amp;onceTaken,^{ })</code>方法里的代码也就是任务将从始至终只会被执行一次。</p>
</li>
</ul>
<blockquote>
<p>#互斥锁</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">@synchronized(锁对象) &#123; // 需要锁定的代码  &#125;</div><div class="line"></div><div class="line">static id _instance;</div><div class="line">+ (instancetype)allocWithZone:(struct _NSZone *)zone</div><div class="line">&#123;</div><div class="line">    @synchronized(self) &#123;</div><div class="line">        if (_instance == nil) &#123;</div><div class="line">            _instance = [super allocWithZone:zone];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    return _instance;</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (instancetype)sharedInstance</div><div class="line">&#123;</div><div class="line">    @synchronized(self) &#123;</div><div class="line">        if (_instance == nil) &#123;</div><div class="line">            _instance = [[self alloc] init];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    return _instance;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (id)copyWithZone:(NSZone *)zone</div><div class="line">&#123;</div><div class="line">    return _instance;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>优点：能有效防止因多线程抢夺资源造成的数据安全问题<br>缺点：需要消耗大量的CPU资源<br>前提：多条线程抢夺同一块资源<br>线程同步：多条线程在同一条线上执行（按顺序地执行任务）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">atomic：原子属性，为setter方法加锁（默认就是atomic），线程安全，需要消耗大量的资源</div><div class="line">nonatomic：非原子属性，不会为setter方法加锁，非线程安全，适合内存小的移动设备，尽量避免多线程抢夺同一块资源，尽量将加锁、资源抢夺的业务逻辑交给服务器端处理，减小移动客户端的压力</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/09/重庆小面/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Carden007">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://static.pexels.com/photos/33392/portrait-bird-nature-wild.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Carden's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/09/重庆小面/" itemprop="url">重庆小面</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-09T10:43:49+08:00">
                2017-06-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://upload-images.jianshu.io/upload_images/1931381-f38d4adb5e1d9ff4.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<blockquote>
<p>###<strong>竞争力</strong>？</p>
</blockquote>
<p>1、好味道：小面的口味如果追求正宗，对于北方人还是过于刺激了一点。如果抛开这一点而加以改良，小面又没有很强的不可替代性，所有改良但是不失个性最重要。这个没什么好说的，所谓餐馆的生命线，后面一切的根本，实践才是检验真理的唯一标准。</p>
<p>2、有卖点：麻辣鲜香，首先是嗅觉去找，然后才是靠味觉评判，至少至少看起来有想拍照发朋友圈的冲动，所有碗必须要有特点；面条不是重庆发明，以面条口感来评判肯定赶不上北方的拉面和手擀面，之所以受欢迎主要就是作料的复合香味、重庆小面最重要的就是红油香，换句话说其实来吃小面就是做好了吃重口味的准备，红油必须让人回味无穷；川渝的炸酱面多了点辣辣香香的感觉，北方的有种甜甜的感觉，并没有必要适应北方将辣香改成甜味，毕竟不改还有一堆死忠粉，改了也拼不过本地本来就是甜味的炸酱面；</p>
<p>3、回头客：华丽的包装可以引来惊叹但热情褪去难以培养用户粘度，味道值不值这个价才是重复消费的最终考虑；小面本来就是熟客生意，所以谁更懂客户，谁自然生意更好，越是客人的小诉求，越是要高度重视；客人每天吃饭的选择这么多，凭什么选择咱家呢，当然是咱家有别家没有的东西，这个东西当然是味道，严格区分其它家，好不好吃是关键，价钱不合适最多去的频率低一点，不好吃可是再便宜也不去；为什么大家都会觉得妈妈做的菜最好吃，是因为好不好吃本来就因人而异，你要是问到底妈妈做的什么菜最好吃，大家都会先想一下，记得最清楚的就是妈妈做菜的味道，至于到底是什么菜，其实印象不多，所以选择去那一家店，更多的想法是这家店正好是自己现在想要吃的口味；每当问中午吃什么的时候，这个问题好难回答，通常都是口味决定食物，吃什么不重要，令人印象深刻的口味最重要，有没有特点最重要，黑暗中的萤火虫，够鲜明够出众；</p>
<p>4、经营好：差异经营，餐饮品牌集中的核心商圈竞争激烈，倒不如选一个周围人流量大但是竞争没那么激烈的地方，其实竞争激烈与否跟周围并没有多大关系，关键是得有差异性，别人家不能随便替代你，独特性又刚好是人群的刚需，至少要有一种不完全垄断这一品类的味道；定位要清晰，中午想吃得营养就喝羊汤，中午想吃麻辣就吃肥牛米线，中午想吃泡菜就吃驴肉火烧那家的牛肉面，中午想吃炒菜就吃五栋大楼那边的盘盘饭，中午想吃清淡点就吃老北京炸酱面。真的，在车公庄凡是多次去的地方必然是定位清晰有特点的；经营策略，这又得拿车公庄的过桥米线举例，他不仅米线卖的好，更把副食饮料卖到了极致，就不说他取代肯德基麦当劳的油炸食品，更把一部分油炸食品单独对外出售，这就很厉害了呀，两平米不到的地盘最多多放两张桌子，但是换成对外出售炸鸡的窗口分分钟创造更多的利润呀，感觉很有必要写一篇《为什么过桥米线一年能赚100万》来单独阐述车公庄的云南过桥米线。这么多卖米线的，就没见过比他做得更好的，要定位有定位，要爆款有爆款，要人气有人气，要附加值有附加值，简直无敌了，确实有时候碗都没洗干净，但是也确实是好吃呀；顺势而为，车公庄的重庆小面就更特别了，最初本来是加盟火锅，但是周边的主流消费都是中午随便吃一顿，快餐会更受欢迎。最后又卖小面，但是确实太油腻，一个人群中喜欢辣的占五分之一被米线抢走了，喜欢油腻的占八分之一都不到呀，不过他的鸡杂面改良一下绝对是很好的爆款，泡菜也绝对是做出了特色，如果可以，有一个单独出售泡菜的窗口，我都会买。</p>
<p>5、针对性：严格区分红汤和清汤，红汤小面满足麻辣口味，清汤小面则满足清淡口味的人群；如果开发一个微信二维码在桌子上，扫一扫下单，不仅可以记录用户的口味偏好方便二次购买，更可以数据分析了解食客的消费动向进而调整产品策略，或许这是大数据离我最接地气的使用；针对消费群体的人物画像，以最娱乐最有趣最有技术含量的方式增强客人对于我们食物的参与感，把小米那一套人人都是产品经理的精髓偷过来，让这些小年轻觉得这碗面是他自己煮的一样，这就不仅仅是下单后等待服务员端上来的无聊时间了，更是一个类似偷菜抢车位的煮面社交游戏，无需注册无需下载，直接共享WIFI搞煮面的游戏排行榜，顺便再推销个广告啥的，羊毛出在猪身上，别人都赚钱的地方我免费，我想破脑袋以别人看不懂的方式来赚钱，当然广告太LOW了，看完广告面都没心情吃面了；针对不同口味的人群，推销不同的整体解决方案，这就像去农贸市场，只买一样菜总感觉白来了，感觉一样菜少买点多买几样才对得起党和人民一样，就是讲究丰富性，那么就主食分量少一点，价格便宜一点来吸引顾客然后卖套餐，这或许利润更高，反正没试过，但是至少我是清淡口味，你送我个小馒头我会很开心，我是麻辣口味，你送我点泡菜我也会很开心，这也很好地解释了为什么哪些什么羊肉汤和鸭血粉丝汤都分量少，来附带卖烧饼和肉夹馍，手抓饼加不加蛋和加不加肉差别老大了，同样的，重庆小面不来点四川泡菜那还叫小面么；</p>
<p>6、健康性：低热量，现代人都减肥，吃面都会问下有多少卡路里，低热量的美食必然受欢迎，单独的小面很油，但是可以推出营养套餐嘛，配根黄瓜和番茄啥的，至少看起来这些素菜中和了一部分油腻，又填饱了肚子，自然会有忠实粉丝；食材好，以最直观最戏剧的方式告知顾客这碗小面的食材来源，暂时没有更多的想法，但是顾客真的内心很矛盾，一方面你做的不好吃我不喜欢，你做的好吃吧我又怀疑你有没有用地沟油或是鸡精味精香料超标，所以得想方设法打消这层顾虑，同样是水，为什么就觉得依云矿泉水更高级呢，不都是水吗，反正又没毒；</p>
<p>7、品类全：圆刀、粗刀、韭叶面，甚至说有正宗的四川泡菜或是秘制卤菜都可以成为受欢迎的理由。很多时候，主食没火，副食却火得不要不要的。比如说送个卤鹅掌，口水鸡，钵钵鸡，伤心凉粉，豆腐脑什么的。把重庆小面和成都副食结合起来，给顾客提供整体解决方案。买产品总是没有卖场景利润高。你来买钓鱼竿，我把钓鱼船都推销给你。不仅仅是为了多赚钱，更重要的是勇敢尝试找到市场的突破口。反正我觉得好吃的东西就要想方设法让你尝一尝，一开始老板心中的爆款总是想当然，还是得通过实验来证明到底什么才是顾客最爱，如果有可能，还可以单独开设一个窗口对外售卖这种副食品呢，老干妈就是这么玩起来的嘛！</p>
<p>8、有情怀：除了想怎么做广告推广，更应该有一份工匠精神，对美食的爱和敬畏的情怀，时刻思索怎么做出更好吃的美食，不能因为铜臭而玷污美食。对食材精挑细选，享受做菜的过程，哪怕切菜都很讲究，喜欢点评各类美食，对菜的色香味很挑剔。除了赚钱更应该对自己的作品按摩了别人的味蕾而充满成就感，然后再顺便赚更多的钱；就像可口可乐百事可乐卖快乐、哈根达斯卖爱情、绿箭卖社交、星巴克卖美好生活一样，把产品打造成一种情感，简单来说，我来你家吃饭，不仅仅是吃饭，更是我觉得你这个老板挺好；勇敢创新，世界上根本就没有什么食谱，只不过一个巧打误撞做了一道让人大为称赞的菜，然后才不断改良写成了食谱，可是真正的美食从来都没有固定的样子，尝试本身就是种乐趣，万一你自己就是个有天赋的神厨呢？</p>
<blockquote>
<p>###<strong>卖什么？</strong></p>
</blockquote>
<p>秦云老太婆摊摊面、盅盅面、愚小面、嘿小面、煮打哥小面、三十三碗面、养生火锅、烤肉、瓦罐小吃、泡芙店、芝士茶饮、砂锅菜、粗粮果蔬卷、荷叶饭、披萨、肉蟹汉堡、蒸菜、烤鱼、五味香锅、多元口味冰淇淋、寿司店、铁板快餐、韩餐港饮、秘制餐包、石锅类、特色面馆、麻辣烫、渝和，川竹面馆，冒菜，酸辣粉，蛋糕点心，奶油面包其实也蛮不错的，投入小，见效快。</p>
<p>1、扩展性：副食衍生，南方人吃面就是吃面，几分钟就完成，而北方不一样，他们吃面会点小菜、凉菜、卤菜，甚至喝两口都有可能，所以北方面馆可以拥有更多的衍生产品；交叉经营，卖小面的也卖冒菜很正常，但是主要卖冒菜或是麻辣烫的去卖小面就感觉不靠谱了，就像苹果说要买汽车我们觉得很靠谱呀，但是奔驰要造手机和电脑咋就感觉很奇怪呢，可能本质上，吃小面的人吃的并不是面，而是麻辣鲜香的味道；</p>
<p>2、知名度：a、小面面馆的规模至少是重庆火锅店的五倍，数量可能有七八万家之多，包括面馆、路边摊等，就业人数有几十万 b、《舌尖》《小面》纪录片激发了庞大的市场 c、一方面不能盲目跟风，另一方面人们跟风不正是因为小面在风口上么，所以骗子很多，赚钱的也很多</p>
<p>3、个性化：a、各家味道并不相同，所以自己可以自由发挥的空间很大，一般不会受到厨师人员流动的威胁  b、熙熙攘攘的人群里让别人一眼认出你，就需要与众不同吗，从装修到餐具，都是提现差异性的地方，不求最好，但求最个性 </p>
<p>4、潜力股：a、市场成熟，竞争激烈的同时供应链等基础设施很完善 b、附加值，可以在悄无声息间转移利润重心 c、小面是主食，主食的目的是吃饱补充能量，恰好面食的花样最繁多，很容易就能适应当地口味  d、很多人能吃好几天小面当正餐，酸辣粉是尝鲜爽口的副食小吃，即便是在重庆本地，也很少有人能连续吃好几天酸辣粉，高油高盐高辣椒，长期食用对身体健康也不利，所以主食天然就具有重复消费的潜力</p>
<p>5、人力少：a、相比中餐不上菜 b、翻台率高  c、二维码下单收银员都省了</p>
<p>6、卖健康：很多人吃麻辣烫都会加点面，为何不发明一种蔬菜面，主打维生素蔬菜面条，打造一种专为减肥或是素食主义者准备的素面。</p>
<p>7、卖小资：为什么白领去海底捞或是星巴克总想发朋友圈炫一下呢，值得深思</p>
<p>8、卖社交：当初韩寒开餐厅本来想要通过开设一个文艺餐馆吸引一大群年轻人进行交友，但是没成功，但是如果谁真的把餐馆做成一个像酒吧的陌生人社交，那该是多特别！当然啦，目前想法根本不现实。我就不明白了，还是火车上认识陌生人最方便呀！</p>
<blockquote>
<p>###<strong>卖给谁？</strong></p>
</blockquote>
<p>0、客户：顾客画像很重要，对顾客群体大致有一定得数据分析挖掘能力，如此才有针对性，俏江南开在贫民窟能不亏么。身份区分—学生、上班族、旅客、白领、文艺青年、社区居民、游客。消费层次区分—富人、老百姓、中产阶级。口味区分—麻辣、清淡、酸甜。</p>
<p>1、地方：车站、学校、写字楼</p>
<p>2、价格：周边消费；人群消费的动向；保证好食材、工人薪资和服务品质，大部分顾客不是为便宜买单，而是为美味即健康的美食买单；</p>
<p>3、产品 ：卖优质还是卖特色体验（食物特色装修特色），典型的超级玛丽餐厅其实就是卖80后回忆；当地消费者口味；目标用户群倾向的店铺装修设计风格；拥有自己独特的标签和精神内核作为支撑，拥有一群死党；</p>
<p>4、宣传：针对目标人群进行针对性宣传，当然产品好那才叫广告，产品不好搞噱头那只能叫作死</p>
<blockquote>
<p>###<strong>怎么卖?</strong></p>
</blockquote>
<p>1、主推爆款：单品突破，将消费者的心智定位在我们最拿手的产品上，然后单品带动其他产品，拉动店面整体流水和经营利润。主推豌杂面和牛肉面，加上鸭血米线和尖椒鸡，可以覆盖面与米线的主食，再推几个包含小吃的套餐，比如一些四川特色小吃红糖糍粑，金牌猪手。增加顾客的选择，提高盈利水平。如果能做到羊毛出在猪身上的互联网盈利模式最好，小面不赚钱，通过利润率更高的小吃来盈利。我就一直很好奇，车公庄云南过桥米线的肥牛米线咋就这么厉害，几乎征服了中国各个地方的口味。简直就是黑白iphone走天下呀！</p>
<p>2、定位清晰：保证招牌的核心价值，坚决不让熟客丢失</p>
<p>3、运营推广：线上和线下，广告关键词：面条劲道、重油重辣、有火锅味、味道绵长、杂酱味美、纯手工制作、卫生健康、麻辣鲜香、豌豆软、臊子鲜、外婆肥肠面、清汤小面搭配香辣猪耳朵丝、独特新颖、花椒麻、海椒香、面条是自家压制，加入蔬菜汁，绿色健康、正宗麻辣小面，牛肉入口化渣、面条筋道，汤汁香气浓郁，不重油、分量足，味道鲜、独创野山菌面，味道独特、老重庆风味，麻辣鲜香、牛肉面采用牛肉原汤，非常鲜香、豌豆入口化渣，油辣子香 、重庆老字号、味道正宗，环境干净整洁、汤汁鲜美，作料够味、自制面条，爽滑劲道、杂酱味鲜汁浓、重庆老字号，传统小面味道、牛肉软糯，汤汁鲜美 、秘制牛肉面、泡椒猪肝面，环境干净卫生、卤面香，服务好 、面条滑爽、有弹性、海椒香、味道重、百年老字号，面条里放芥末，味道“酸甜麻辣冲、浇头丰富，凉拌拱嘴面、开胃猪杂面等特色品种</p>
<blockquote>
<p>###<strong>做成品？</strong></p>
</blockquote>
<ul>
<li>面？</li>
</ul>
<p>碱水面，又分“水面”和“干面”：前者含大量水分，后者晾晒脱水。水面成份包括：高筋面粉、淀粉、盐、水，水含量30%、食碱。因为新鲜水面容易发酸。过去保鲜条件有限，因此在水面中加入食用碱，防止过快发酸。而加碱水面配合小面佐料，形成具有独特口味。用下过面的二道水煮面，保留之前的面和菜的香气。“水宽、火大、常换”。锅深，水多，火大，面可以一直悬浮在水中确保受热均匀。煮面的同时一手要用筷子不停搅动，另一只手不时加一些凉水防止面扑出来。面的含水量要达到30%，重庆人称之为“水面”。而且，有了得当的调料和调配手艺，面的口感却在于挑面师傅的火候掌控。每个人的软硬标准不同，挑面师要掌握你的标准一定要经过一番了解与调整，这就是为什么每个人早上吃小面的地方大致固定的原因。入口的是面条，吃的却是调料。麻辣为基础，佐料十几种：油辣子、花椒、酱油、猪油、鸡精、葱花、姜蒜水、芽菜末、榨菜粒、芝麻或芝麻酱、熟花生碎，还可以加入豌豆或者牛肉粒等等。</p>
<ul>
<li>麻</li>
</ul>
<p>“麻”来自花椒，花椒的选料很重要，翻炒也很关键，火候必须拿捏得当，需要用铁锅将新鲜花椒“坑”香，最后再打出粉末；青花椒和红花椒，茂汶花椒最好。花椒先炒再磨粉，尽量将花椒中的香味提取出来。</p>
<ul>
<li>辣</li>
</ul>
<p>“辣”则是油辣子，须用纯正菜籽油，在油温200℃时，浇盖辣椒面，紧接着放入芝麻和花生，油温120℃再浇盖，最后用小火慢慢炒制；制作油辣子海椒经常会用到的干海椒有三种，分别是四川二荆条、贵州大红袍和湖南朝天椒，其中的二荆条和大红袍偏重于香味，而朝天椒则偏重于辣味，因此很多人在制作油辣子海椒时一般会将这几种辣椒混合使用，以求达到更完美的境界。</p>
<p>1、 备料:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">料A：菜籽油、洋葱、小葱、香芹、胡萝卜</div><div class="line"></div><div class="line">料B：香叶、八角、茴香、桂皮、白蔻、丁香、香果、草果、毕拨、良姜、山奈、砂仁、甘草。</div><div class="line"></div><div class="line">料C：天鹰椒、内黄新一代、灯笼椒、红花椒，青花椒（油辣椒）</div><div class="line"></div><div class="line">料D：天鹰椒、内黄新一代、灯笼椒、红花椒（干辣椒）</div></pre></td></tr></table></figure>
<p>2、 制作：（注意事项：油温控制、辣椒颜色、火候把控、不断搅拌）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">第1步：菜籽油5斤中火烧熟，关火冷却至4层热。放入料A、炸至金黄色捞出去渣。</div><div class="line"></div><div class="line">第2步:  油温5成热放入料B、香叶香脆捞出油备用。</div><div class="line"></div><div class="line">第3步：锅中油烧至5成热放料D快速炸干至深红色捞出，放芝麻；将10克花椒放入油中榨干捞出、把炸好的辣椒摊开放入簸箕中、快速冷却、冷却后放入擂钵中、放入花生擂至小手指粗细。（备注：即制成了干辣子）。</div><div class="line"></div><div class="line">第4步：倒出锅中油、放入料C，细火不断翻炒至颜色深红（注：炕海椒）、马上倒出铺开入少许花生。擂细成辣椒面，倒出备用。炕辣椒分为三次：第一次、辣椒稍脆、水分已干、烫手关火冷却；第二次、辣椒完全炕好、轻易捏脆、烫手；第三次，先导入少量生菜油、中火炕香、放入红花椒、出麻辣香味关火倒入簸箕、冷却放入擂钵加花生擂碎、捞出备用。把第2步打碎的香料放入辣椒面中、同时加入少许白糖。</div><div class="line"></div><div class="line">第5步：锅中油加温至180°（油面有浓烟）关火。加入100克芝麻和少许青花椒榨香炸脆后捞出倒入辣椒面中。马上浇1斤油入辣椒面中，把辣椒榨香；油温冷却至5成熟放入辣椒籽榨成金黄色捞出倒入辣椒面中，浇一斤油，快速搅拌出香味。油温冷却至3成热，全部的油浇入辣椒面中、快速搅拌出颜色。过热的油去浇辣椒，会糊的，卖相就不好看了。</div><div class="line"></div><div class="line">第6步：放入5ML白醋搅拌。</div></pre></td></tr></table></figure></p>
<p>3、升华：做好的油辣子海椒，放一颗洗干净晾干的核桃进去泡着，辣椒会非常香</p>
<ul>
<li>鲜</li>
</ul>
<p>“鲜”是汤头，用骨头熬制的鲜汤配上猪油，四川有句行话“川戏的腔，川菜的汤”；味精或鸡精也可提升鲜味，口感更丰富。味极鲜也可以加一点。酱油就是将各种佐料的香气融合在一起，调节味道。老抽生抽都可以，两个都放也可以，自己喜好。半勺猪油加小面，提高汤的醇厚，增添脂香味，口味浓郁。虽然这个很不健康，但是不放绝对不好吃，多加点更好，不喜欢可以用普通的油代替，但是口感绝对有差，色拉油、橄榄油、花生油和调和油通通比不上猪油的味道。1.制高汤：选用猪筒骨、杂骨，清洗后放入沸水锅内出水，捞起用温热水将血垢和浮沫洗净，锅中另掺清水放入筒骨、杂骨，用小火慢炖，至汤味香醇。2.炼制猪油：猪板油洗净后撕去蒙皮，改成2厘米的块，用小火熬制，待猪油出油已尽，形态干缩时，打去油渣，把油汁盛入容器中备用，我妈就在家熬过呢，北方几乎没有看到耶。</p>
<ul>
<li>香</li>
</ul>
<p>“香”来自海椒，尽管与油辣子的原料相同，但要求却完全不同，油辣子要求辣味纯正，而海椒却要辣中带香。辣椒通常选重庆子弹头辣椒、四川二荆条、贵州大红袍或是湖南朝天椒。用油反复翻炒烘干后木槌捣碎，辣椒面再加草果、核桃壳、芝麻用热油煎匀，鲜香醇厚色泽鲜艳。榨菜切小粒，提升咸鲜味和清香感，不致太油腻。超市最好买的涪陵榨菜就行，切碎，炒一下更香。一碗小面里少不了蔬菜，通常会添加时令菜：春天是新鲜嫩绿的豌豆尖，夏天是空心菜，秋冬有莴笋叶，还有菠菜、瓢儿白、黄秧白、小白菜等等，绿油油的菜叶子配上红腾腾的麻辣小面，色彩艳丽，卖相诱人。不放豆瓣酱绝对没有川渝地区的味道啊！不放豆瓣酱绝对没有川渝地区的味道啊！不放豆瓣酱绝对没有川渝地区的味道啊！</p>
<ul>
<li>料</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">1.炼红油：选用表皮光亮、色红肉厚的干辣椒，经去蒂、去籽后放入铁锅内，加少许食用植物油翻炒炕熟，冷却后舂成碎末，装入容器内;食用植物油入锅内烧至160℃～190℃，然后将油舀入盛辣椒末的容器内，边舀入食用植物油脂边搅动辣椒末，达到色泽红亮，辣中带香的要求。辣椒末与食用植物油比例为1：2.5～3.0。</div><div class="line"></div><div class="line">2.调制姜水：老姜洗净去皮，捣绒后用冷开水调匀;其与冷开水的比例均为1：3～3.5。</div><div class="line"></div><div class="line">3.调制蒜水：大蒜去皮，捣成泥后用冷开水调匀;蒜泥与冷开水的比例均为1：3～3.5。</div><div class="line"></div><div class="line">4.预制榨菜粒：榨菜经洗净，挤干水分，切成约0.3厘米的颗粒状。</div><div class="line"></div><div class="line">5.预制葱花：小葱或火葱经粗加工清洗干净后，沥干水分，切成长度为0.3厘米～0.5厘米的葱颗备用。</div><div class="line"></div><div class="line">6.预制熟碎花生仁：花生仁洗净后沥干水分，投入到热食植物油锅内炸至酥脆起锅，冷却后铡成颗粒状。</div><div class="line"></div><div class="line">7.预制熟芝麻：芝麻淘洗后沥干水分，放入铁锅内用小火炒香至熟。</div><div class="line"></div><div class="line">8.预制芝麻酱：将芝麻酱用芝麻油调散，呈浆状;芝麻酱与芝麻油的比例为1：1.2～1.4。</div><div class="line"></div><div class="line">9.预制花椒粉：将干燥去籽花椒，粉碎成粉。</div></pre></td></tr></table></figure>
<hr>
<blockquote>
<p>###<strong>讲故事？</strong></p>
</blockquote>
<p>14年第一家小面是我第一次涉足，但多年的经商让我知道，没有准备的仗是打不好的，于是一有看店机会，我都认真分析对待，就拿我第一家店来说，地处北京南锣鼓巷地铁站F口旁边位置，在我之前，都没做餐饮而是其它，很多做餐饮的人来看了30平，周围除了个小卖部和一个理发的没有别的什么了，都不看好，觉得都不如南锣鼓巷里边，但我却不这么认为，南锣鼓巷里人流确实大，可以和过年北京西站的人流比，但这里租金有好高，一个2-3平的档口也要一月2-3万甚至更高，黑死人，还有这么大的人流都是旅游的你想会在这种环境下吃饭吗，就算可以，那也是人满为患，品质、服务也得不到保障，关键是一个30平能开面馆的地方可以到一月租金七、八万，无论从开店环境到成本不应该是个面馆所能承受的，所以，我接受不了。</p>
<p>回过头说说地铁口这个位置，紧邻地铁，又是路口，虽然商业气氛不浓但人流还是很多。最主要他离南锣鼓巷只有100米，我认真看了一下，很多游客从里出来都是又累又饿的样子，急于找个地方歇脚休整下，还有坐地铁的人也差不多这样，我又连续3天早、中、晚不同时间段去数人数，在店面前数对流客人每10分钟的数量，基本都能达到200人以上，虽然也是30平，但没人要，我要，月租11000元，好了，没问题了，租下开吧。2014年12月05号，我的第一家店经过装修等顺利开张了。第一个月每天2000多，保平了，随著时间推移口味也还行，价格合理，逐渐3000多，4000多，5000多，到了2015年春节时已经稳坐日流水5000-6000了，有时节假日8000多，这说明什么问题，消费人群和选址非常重要！非常重要！非常重要！</p>
<p>接着就一发不可收了，除了生意还行，好多人吃过后要加盟呀什么的，这我同样没有急于去做，为什么？虽然名字是取好了，商标怎么办？大量的加盟，原材料怎么办？这些东西不做好，加盟就是毁灭性的。于是我就暂缓加盟，先去申请了商标，然后我一路开车到南京品孟非小面，到成都考察各种原材料，最后才回到家—重庆，先是一通的吃遍重庆有名的小面，学习了一下，最后得出一个结论，油辣子是关键，我虽有配方，但如果一下加盟挺多每天要炒多少料且保证味道一样，再者，北方气候和南方不同，湿度也不同，连水都有区别，怎样保持炒料的味道成了关键问题，砸了都好说点，可别害了加盟的人，想来想去，不行，要自己成量做，我找到一家做调料的厂，租用人家的设备人员开始按配方进行电脑炒料，经过不断尝试终于成功，形成批量化生产，且口味和人工一致。终于解决了所有后顾之忧，回到北京在短短一年直营和加盟开了十家，因为质量过硬口味好，所有店顾客盈门，实现品牌利益双丰收。同年，注册品牌得到通过，并在2015年在重庆市商委、广电总局、重庆市餐饮行业协会、重庆市科教频道、重庆市小面专委会举办的首届小面文化节一举多得18强。所以，质量才是制胜法宝，特色决定成败，品牌决定未来！用心去做，因地制宜，成功就不远了！</p>
<p>很多小面店是手把手的教学员，在统一原料供应的基础上，专门把学员召集起来，培训打作料的“手感”，力求达到100%的复制，不合格不准出师，这是“手艺派”；相比于“靠感觉”的打作料，“工业化”则是通过中央厨房，把配好的原料配送给一家家的加盟店。因为一旦标准化，很多人的担心就会变成现实：千店一味的重庆小面，哪里还有什么特色和魅力。做熟客</p>
<p>重庆小面的面需要碱面，北京少有这样的面条供应商，稍好一点的面馆也都是采用了自己做的解决办法，自己面是没问题的，一个机器一些工序就能搞定，但北京对碱面（食品添加的问题）管得十分严格，没投诉还好，如果有投诉就违反了食品安全云云。所以，北京吃到的面大多数碱是不够的。</p>
<p>其次，水，北京的水有多糟糕，载北京待过一段时间的南方人大多知道，特别是重庆的水自来水放出来都没有水垢呢，北京的水一次就能把电水壶筑底成功。如果让店家用净化水，吗成本又上去了，谁乐意呢？其实纯净水做出来的味道就是没有嘉陵江的水好喝。水也不可能给你运过来下小面吧！所以还是供应链的问题。</p>
<p>非常重要的调料也是个问题，问题不在调料本身，而是在选择。调料的原料价格高，重量轻（相比之下），运到北京来一点没有问题，比如有些餐馆，都是四川、重庆直供调料的，保证了原汁原味。但，那是餐厅酒店啊，比如渝信、等等其他的，川菜做出来可比小面的附加值高吧，所以用得起呢。虽然小面的附加值是蛮高的，川菜和小面同样是从重庆、四川出来以后，路就完全不同了。</p>
<p><strong>北京的正宗重庆小面？</strong></p>
<p>好这口小面</p>
<p><strong>地址：东三环南路48号，双井双流辣妈兔头旁边</strong></p>
<p>亲爱的面</p>
<p><strong>地址：海淀区双榆树西里32号，靠近人大东门</strong></p>
<p>碗碗重庆小面</p>
<p><strong>地址：青年路国美第一城3号院1号楼底商</strong></p>
<p>有家豌杂重庆小面</p>
<p><strong>地址：建外大街永安西里10号新华保险大厦南侧</strong></p>
<blockquote>
<p>###“中国十大名面”？</p>
</blockquote>
<p>陕西biangbiang面</p>
<p>山西刀削面</p>
<p>四川担担面</p>
<p>河南烩面</p>
<p>延吉冷面</p>
<p>兰州牛肉面</p>
<p>山东炝锅面</p>
<p>武汉热干面</p>
<p>广东云吞面</p>
<blockquote>
<p>####小面纪录片</p>
</blockquote>
<p>《嘿！小面》《舌尖上的中国·第二季》</p>
<blockquote>
<h4 id="小面培训"><a href="#小面培训" class="headerlink" title="小面培训"></a><strong>小面培训</strong></h4></blockquote>
<p>2014年的报道，重庆厨师协会会长说：“今年跑来重庆要求学习小面的人很多，除了国内，有的还从巴黎、纽约飞过来学小面。一般一家都带有3-5个学徒，有的还有10-20个学徒，加上还有一些培训学校，初步估计，今年来，至少有数万人在重庆学做小面。”</p>
<p>“123台灯”说接受采访时说：“获评重庆小面50强的一家小面馆，以前培训费是8000元，从去年底后就开设了小面制作培训课程，眼下培训费已涨到了2.2万元，就是这个学费，仍然有不少人趋之若鹜，而这家小面馆老板光培训费就挣了近千万元。”如今，就算在东北的哈尔滨，打着重庆小面招牌的至少也有上千家。2014年11月，重庆籍主持人孟非在南京开了一家主打重庆小面的餐馆，又一次把重庆小面推上了舆论风口，而此时，重庆小面已经覆盖到全国绝大部分地区。北方口味，以及难以理解的麻酱），只要满足大众口味，面差一点、味道差一点、不够辣（不法之徒常用辣椒素而不是辣椒油混合调料，这样极其伤胃，这种水平在重庆是混不走的，也就只有骗骗外地人）、不够麻、不够酸、不够干（北京的重庆小面不太会做干馏儿）的小面只要价格合适，观众还是能出现的。这就是题主吃不到重庆小面的原因。小面的口味如果追求正宗，对于北方人还是过于刺激了。如果抛开这一点而加以改良，小面并没有很强的不可替代性</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://static.pexels.com/photos/33392/portrait-bird-nature-wild.jpg"
               alt="Carden007" />
          <p class="site-author-name" itemprop="name">Carden007</p>
           
              <p class="site-description motion-element" itemprop="description">人生有很多事情急不得，没有白走的路，走每一步都算数。</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Carden007</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  

  

  

  

  

</body>
</html>
